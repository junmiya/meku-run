(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4770:e=>{"use strict";e.exports=require("crypto")},665:e=>{"use strict";e.exports=require("dns")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},5816:e=>{"use strict";e.exports=require("process")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},1230:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(908),r(4452),r(5866);var i=r(3191),s=r(8716),n=r(7922),o=r.n(n),a=r(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,908)),"/workspace/firebase-word-card-app/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,4452)),"/workspace/firebase-word-card-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/workspace/firebase-word-card-app/app/page.tsx"],u="/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},847:(e,t,r)=>{Promise.resolve().then(r.bind(r,1819))},1819:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var i=r(326),s=r(7577),n=r.n(s),o=r(4139),a=r(9678),l=r(7259),d=r(76),c=r(445);class u{static{this.STORAGE_KEY="hyakunin-isshu-training-sessions"}constructor(){this.currentSession=null,this.sessionHistory=[],this.timer=null,this.startTime=0,this.user=null,this.unsubscribeListener=null,this.currentState={isActive:!1,currentPhase:"setup",timeRemaining:0,sessionStats:{totalAttempts:0,correctAnswers:0,currentStreak:0,bestStreak:0}}}static getInstance(){return u.instance||(u.instance=new u),u.instance}setUser(e){this.user?.uid!==e?.uid&&(this.cleanup(),this.user=e,e?this.loadFromFirestore():this.loadFromStorage())}getCurrentUser(){return this.user}startSession(e,t,r){return this.currentSession&&this.endSession(),this.currentSession={sessionId:this.generateSessionId(),startTime:new Date,mode:e,kimarijiLevel:t,settings:r,results:[]},this.currentState={isActive:!0,currentPhase:"memorization"===e?"memorization":"active",timeRemaining:"memorization"===e?r.memorizationTime:r.timeLimit,sessionStats:{totalAttempts:0,correctAnswers:0,currentStreak:0,bestStreak:0}},this.startTimer(),this.currentSession}endSession(){if(!this.currentSession)return null;this.stopTimer(),this.currentSession.endTime=new Date;let e=this.calculateStatistics();e&&(this.currentSession.statistics=e),this.sessionHistory.push(this.currentSession),this.currentState.isActive=!1,this.currentState.currentPhase="finished",this.user?this.saveToFirestore():this.saveToStorage();let t=this.currentSession;return this.currentSession=null,t}pauseSession(){this.currentSession&&this.currentState.isActive&&(this.stopTimer(),this.currentState.currentPhase="waiting")}resumeSession(){this.currentSession&&"waiting"===this.currentState.currentPhase&&(this.currentState.currentPhase="active",this.startTimer())}recordAnswer(e,t){if(!this.currentSession)throw Error("アクティブなセッションがありません");let r={cardId:e,responseTime:Date.now()-this.startTime,correct:t,timestamp:new Date,kimarijiLength:this.getKimarijiLength(e)};return this.currentSession.results.push(r),this.updateStats(t),r}setCurrentCard(e){this.currentState.currentCard=e,this.startTime=Date.now()}getCurrentState(){return{...this.currentState}}getCurrentSession(){return this.currentSession}getSessionHistory(){return[...this.sessionHistory]}getStatsByMode(e){let t=this.sessionHistory.filter(t=>t.mode===e&&t.statistics);if(0===t.length)return{totalSessions:0,averageCorrectRate:0,averageResponseTime:0,bestSession:null};let r=t.reduce((e,t)=>e+t.statistics.correctAnswers/t.statistics.totalCards,0),i=t.reduce((e,t)=>e+t.statistics.averageResponseTime,0),s=t.reduce((e,t)=>t.statistics.correctAnswers/t.statistics.totalCards>e.statistics.correctAnswers/e.statistics.totalCards?t:e);return{totalSessions:t.length,averageCorrectRate:r/t.length,averageResponseTime:i/t.length,bestSession:s}}clearHistory(){this.sessionHistory=[],this.user?this.saveToFirestore():this.saveToStorage()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}startTimer(){this.stopTimer(),this.timer=setInterval(()=>{this.currentState.timeRemaining--,this.currentState.timeRemaining<=0&&this.onTimeUp()},1e3)}stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}onTimeUp(){"memorization"===this.currentState.currentPhase?(this.currentState.currentPhase="active",this.currentState.timeRemaining=this.currentSession.settings.timeLimit):this.endSession()}updateStats(e){this.currentState.sessionStats.totalAttempts++,e?(this.currentState.sessionStats.correctAnswers++,this.currentState.sessionStats.currentStreak++,this.currentState.sessionStats.currentStreak>this.currentState.sessionStats.bestStreak&&(this.currentState.sessionStats.bestStreak=this.currentState.sessionStats.currentStreak)):this.currentState.sessionStats.currentStreak=0}calculateStatistics(){if(!this.currentSession)return;let e=this.currentSession.results,t=e.filter(e=>e.correct);return{totalCards:e.length,correctAnswers:t.length,averageResponseTime:e.reduce((e,t)=>e+t.responseTime,0)/e.length,fastestResponse:Math.min(...e.map(e=>e.responseTime)),slowestResponse:Math.max(...e.map(e=>e.responseTime))}}getKimarijiLength(e){return 1}loadFromStorage(){try{let e=localStorage.getItem(u.STORAGE_KEY);if(e){let t=JSON.parse(e);this.sessionHistory=t.sessions||[]}}catch(e){console.warn("トレーニングセッション履歴の読み込みに失敗しました:",e)}}saveToStorage(){try{let e={sessions:this.sessionHistory};localStorage.setItem(u.STORAGE_KEY,JSON.stringify(e))}catch(e){console.warn("トレーニングセッション履歴の保存に失敗しました:",e)}}async loadFromFirestore(){if(this.user)try{let e=(0,d.JU)(c.db,"users",this.user.uid),t=(0,d.JU)(e,"training","sessions");this.unsubscribeListener=(0,d.cf)(t,e=>{if(e.exists()){let t=e.data();t.sessions&&(this.sessionHistory=t.sessions.map(e=>({...e,startTime:e.startTime?.toDate?e.startTime.toDate():new Date(e.startTime),endTime:e.endTime?.toDate?e.endTime.toDate():e.endTime?new Date(e.endTime):void 0})))}})}catch(e){console.warn("Firestoreからのトレーニングセッションデータ読み込みに失敗しました:",e),this.loadFromStorage()}}async saveToFirestore(){if(this.user)try{let e=(0,d.JU)(c.db,"users",this.user.uid),t=(0,d.JU)(e,"training","sessions"),r={sessions:this.sessionHistory,lastUpdated:(0,d.Bt)()};await (0,d.pl)(t,r,{merge:!0})}catch(e){console.warn("Firestoreへのトレーニングセッションデータ保存に失敗しました:",e)}}cleanup(){this.unsubscribeListener&&(this.unsubscribeListener(),this.unsubscribeListener=null)}}class h{static{this.STORAGE_KEY="hyakunin-isshu-performance-data"}constructor(){this.cardPerformances=new Map,this.sessionHistory=[],this.user=null,this.unsubscribeListener=null}static getInstance(){return h.instance||(h.instance=new h),h.instance}setUser(e){this.user?.uid!==e?.uid&&(this.cleanup(),this.user=e,e?this.loadFromFirestore():this.loadFromStorage())}getCurrentUser(){return this.user}recordTrainingResult(e){let t=e.cardId,r=this.cardPerformances.get(t);r||(r={cardId:t,totalAttempts:0,correctAnswers:0,averageResponseTime:0,fastestResponse:1/0,slowestResponse:0,recentAttempts:[],difficulty:"medium",lastPracticed:new Date}),r.totalAttempts++,e.correct&&r.correctAnswers++,r.averageResponseTime=(r.averageResponseTime*(r.totalAttempts-1)+e.responseTime)/r.totalAttempts,r.fastestResponse=Math.min(r.fastestResponse,e.responseTime),r.slowestResponse=Math.max(r.slowestResponse,e.responseTime),r.recentAttempts.push(e),r.recentAttempts.length>10&&r.recentAttempts.shift(),r.difficulty=this.calculateDifficulty(r),r.lastPracticed=new Date,this.cardPerformances.set(t,r),this.user?this.saveToFirestore():this.saveToStorage()}updateSessionHistory(e){this.sessionHistory.push(e),e.results.forEach(e=>{this.recordTrainingResult(e)}),this.user?this.saveToFirestore():this.saveToStorage()}getCardPerformance(e){return this.cardPerformances.get(e)}getPerformanceAnalysis(){let e=Array.from(this.cardPerformances.values()),t=e.reduce((e,t)=>e+t.totalAttempts,0),r=e.reduce((e,t)=>e+t.correctAnswers,0),i=this.getKimarijiLevelPerformances(),s=this.getWeakCards(5),n=this.getStrongCards(5),o=this.generateRecommendations(s,i);return{overallStats:{totalSessions:this.sessionHistory.length,totalCards:e.length,totalCorrectAnswers:r,overallAccuracy:t>0?r/t:0,averageResponseTime:this.calculateOverallAverageResponseTime(),improvementTrend:this.calculateImprovementTrend()},kimarijiLevels:i,weakCards:s,strongCards:n,recommendations:o}}getWeakCards(e=10){return Array.from(this.cardPerformances.values()).filter(e=>e.totalAttempts>=3).sort((e,t)=>e.correctAnswers/e.totalAttempts-t.correctAnswers/t.totalAttempts).slice(0,e)}getStrongCards(e=10){return Array.from(this.cardPerformances.values()).filter(e=>e.totalAttempts>=3).sort((e,t)=>{let r=e.correctAnswers/e.totalAttempts;return t.correctAnswers/t.totalAttempts-r}).slice(0,e)}getLearningProgress(){let e=this.getPerformanceAnalysis().overallStats.overallAccuracy,t=this.calculateTotalStudyTime(),r="beginner",i="1字決まりを完全に覚える";return e>=.9&&t>=180?(r="advanced",i="競技レベルの速度を目指す"):e>=.7&&t>=60&&(r="intermediate",i="全ての決まり字を習得する"),{beginner:{completed:e>=.5,accuracy:Math.min(2*e,1),timeSpent:Math.min(t,60)},intermediate:{completed:e>=.7,accuracy:Math.max(0,(e-.5)*2.5),timeSpent:Math.max(0,Math.min(t-60,120))},advanced:{completed:e>=.9,accuracy:Math.max(0,(e-.7)*5),timeSpent:Math.max(0,t-180)},currentLevel:r,nextGoal:i}}getRecommendedPractice(){return this.getKimarijiLevelPerformances().filter(e=>e.recommendedPractice).map(e=>({level:e.level,reason:this.getRecommendationReason(e),expectedImprovement:e.improvementRate})).sort((e,t)=>t.expectedImprovement-e.expectedImprovement)}clearData(){this.cardPerformances.clear(),this.sessionHistory=[],this.user?this.saveToFirestore():this.saveToStorage()}calculateDifficulty(e){let t=e.correctAnswers/e.totalAttempts,r=e.averageResponseTime;return t>=.8&&r<=2e3?"easy":t>=.6&&r<=4e3?"medium":"hard"}getKimarijiLevelPerformances(){let e=[];for(let t=1;t<=6;t++){let r=this.getCardsByKimarijiLevel(t),i=r.reduce((e,t)=>e+t.totalAttempts,0),s=r.reduce((e,t)=>e+t.correctAnswers,0),n=r.length>0?r.reduce((e,t)=>e+t.averageResponseTime,0)/r.length:0;e.push({level:t,totalAttempts:i,correctAnswers:s,averageResponseTime:n,improvementRate:this.calculateImprovementRate(t),recommendedPractice:!(i>0)||s/i<.7})}return e}getCardsByKimarijiLevel(e){return Array.from(this.cardPerformances.values()).filter(t=>this.getKimarijiLevelForCard(t.cardId)===e)}getKimarijiLevelForCard(e){return Math.floor(6*Math.random())+1}calculateOverallAverageResponseTime(){let e=Array.from(this.cardPerformances.values());return 0===e.length?0:e.reduce((e,t)=>e+t.averageResponseTime,0)/e.length}calculateImprovementTrend(){if(this.sessionHistory.length<2)return"stable";let e=this.sessionHistory.slice(-5).map(e=>e.statistics?e.statistics.correctAnswers/e.statistics.totalCards:0),t=e.slice(0,Math.floor(e.length/2)),r=e.slice(Math.floor(e.length/2)),i=t.reduce((e,t)=>e+t,0)/t.length,s=r.reduce((e,t)=>e+t,0)/r.length-i;return s>.05?"improving":s<-.05?"declining":"stable"}calculateImprovementRate(e){let t=this.sessionHistory.slice(-3);if(t.length<2)return 0;let r=t.flatMap(t=>t.results.filter(t=>t.kimarijiLength===e));if(r.length<2)return 0;let i=Math.floor(r.length/2),s=r.slice(0,i),n=r.slice(i),o=s.filter(e=>e.correct).length/s.length;return n.filter(e=>e.correct).length/n.length-o}calculateTotalStudyTime(){return this.sessionHistory.reduce((e,t)=>t.endTime?e+(t.endTime.getTime()-t.startTime.getTime())/1e3/60:e,0)}generateRecommendations(e,t){let r=[];if(e.length>0){let t=e[0];t&&t.correctAnswers/t.totalAttempts<.3&&r.push(`${t.cardId}番の札を集中的に練習しましょう`)}let i=t.find(e=>e.totalAttempts>0&&e.correctAnswers/e.totalAttempts<.5);i&&r.push(`${i.level}字決まりの練習を強化しましょう`);let s=t.reduce((e,t)=>e+(t.totalAttempts>0?t.correctAnswers/t.totalAttempts:0),0)/t.length;return s<.5?r.push("基本的な1字決まりから始めましょう"):s<.7?r.push("2字決まりの練習を増やしましょう"):r.push("競技レベルの速度向上を目指しましょう"),r}getRecommendationReason(e){let t=e.totalAttempts>0?e.correctAnswers/e.totalAttempts:0;return t<.3?"正解率が低いため基礎から練習が必要":t<.7?"正解率向上のため反復練習が効果的":e.averageResponseTime>3e3?"反応時間短縮のため速度練習が必要":"更なる上達のため継続練習が推奨"}loadFromStorage(){try{let e=localStorage.getItem(h.STORAGE_KEY);if(e){let t=JSON.parse(e);t.cardPerformances&&(this.cardPerformances=new Map(t.cardPerformances)),t.sessionHistory&&(this.sessionHistory=t.sessionHistory.map(e=>({...e,startTime:new Date(e.startTime),endTime:e.endTime?new Date(e.endTime):void 0})))}}catch(e){console.warn("パフォーマンスデータの読み込みに失敗しました:",e)}}saveToStorage(){try{let e={cardPerformances:Array.from(this.cardPerformances.entries()),sessionHistory:this.sessionHistory};localStorage.setItem(h.STORAGE_KEY,JSON.stringify(e))}catch(e){console.warn("パフォーマンスデータの保存に失敗しました:",e)}}async loadFromFirestore(){if(this.user)try{let e=(0,d.JU)(c.db,"users",this.user.uid),t=(0,d.JU)(e,"progress","performance");this.unsubscribeListener=(0,d.cf)(t,e=>{if(e.exists()){let t=e.data();t.cardPerformances&&(this.cardPerformances=new Map(t.cardPerformances)),t.sessionHistory&&(this.sessionHistory=t.sessionHistory.map(e=>({...e,startTime:e.startTime?.toDate?e.startTime.toDate():new Date(e.startTime),endTime:e.endTime?.toDate?e.endTime.toDate():e.endTime?new Date(e.endTime):void 0})))}})}catch(e){console.warn("Firestoreからのパフォーマンスデータ読み込みに失敗しました:",e),this.loadFromStorage()}}async saveToFirestore(){if(this.user)try{let e=(0,d.JU)(c.db,"users",this.user.uid),t=(0,d.JU)(e,"progress","performance"),r={cardPerformances:Array.from(this.cardPerformances.entries()),sessionHistory:this.sessionHistory,lastUpdated:(0,d.Bt)()};await (0,d.pl)(t,r,{merge:!0})}catch(e){console.warn("Firestoreへのパフォーマンスデータ保存に失敗しました:",e)}}cleanup(){this.unsubscribeListener&&(this.unsubscribeListener(),this.unsubscribeListener=null)}}let p={};o.g.forEach(e=>{e.kimariji&&(p[e.id]={position:e.kimariji.position,length:e.kimariji.length,pattern:e.kimariji.pattern,category:e.kimariji.category,conflictCards:e.kimariji.conflictCards||[],difficulty:e.kimariji.difficulty,...e.kimariji.notes&&{notes:e.kimariji.notes}})});let m={1:[],2:[],3:[],4:[],5:[],6:[]};Object.entries(p).forEach(([e,t])=>{let r=parseInt(e),i=t.category;i>=1&&i<=6&&m[i]&&m[i].push(r)}),Object.keys(m).forEach(e=>{let t=parseInt(e);m[t]&&m[t].sort((e,t)=>e-t)}),m[1],m[2]?.length,m[3]?.length,m[4]?.length,m[5]?.length,m[6]?.length;let g=e=>p[e],x=e=>m[e]||[],f=e=>Object.entries(p).filter(([t,r])=>r.difficulty===e).map(([e,t])=>parseInt(e));[...f("easy"),...x(1)],[...x(2),...f("medium")],[...x(3),...x(4),...f("hard")],Object.keys(p).length,Object.entries(m).map(([e,t])=>({length:parseInt(e),count:t.length,percentage:Object.keys(p).length>0?t.length/Object.keys(p).length*100:0})),["easy","medium","hard"].map(e=>({difficulty:e,count:f(e).length,percentage:Object.keys(p).length>0?f(e).length/Object.keys(p).length*100:0}));let y=({timeRemaining:e,totalTime:t,phase:r,onTimeUp:s})=>{let n=(()=>{switch(r){case"setup":return{color:"#6B7280",backgroundColor:"#F3F4F6",message:"準備中",showProgress:!1};case"memorization":return{color:"#3B82F6",backgroundColor:"#DBEAFE",message:"暗記時間",showProgress:!0};case"waiting":return{color:"#F59E0B",backgroundColor:"#FEF3C7",message:"一時停止中",showProgress:!1};case"active":return{color:e<=10?"#EF4444":"#10B981",backgroundColor:e<=10?"#FEE2E2":"#D1FAE5",message:"回答時間",showProgress:!0};case"finished":return{color:"#6B7280",backgroundColor:"#F3F4F6",message:"終了",showProgress:!1};default:return{color:"#6B7280",backgroundColor:"#F3F4F6",message:"",showProgress:!1}}})();return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",backgroundColor:n.backgroundColor,borderRadius:"12px",border:`2px solid ${n.color}`,minWidth:"200px",flexDirection:"column",gap:"8px"},children:[i.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:n.color,textAlign:"center"},children:n.message}),i.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:n.color,fontFamily:"monospace",textAlign:"center"},children:`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`}),n.showProgress&&t>0&&i.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#E5E7EB",borderRadius:"4px",overflow:"hidden"},children:i.jsx("div",{style:{height:"100%",backgroundColor:n.color,borderRadius:"4px",transition:"width 0.3s ease-in-out",width:`${t>0?(t-e)/t*100:0}%`}})}),"active"===r&&e<=10&&e>0&&i.jsx("div",{style:{fontSize:"12px",color:"#EF4444",fontWeight:"600",textAlign:"center",animation:"blink 1s infinite"},children:"急いで！"}),e<=0&&"finished"!==r&&i.jsx("div",{style:{fontSize:"14px",color:"#EF4444",fontWeight:"600",textAlign:"center"},children:"時間切れ"}),i.jsx("style",{children:`
        @keyframes blink {
          0%, 50% { opacity: 1; }
          51%, 100% { opacity: 0; }
        }
      `})]})},b=({onModeSelect:e,onKimarijiLevelSelect:t,onSettingsChange:r})=>{let[s,o]=n().useState("memorization"),[a,l]=n().useState("mixed"),[d,c]=n().useState({timeLimit:60,memorizationTime:15,judgeMode:"normal"}),u=t=>{o(t),e(t)},h=e=>{l(e),t(e)},p=e=>{c(e),r(e)};return(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"24px",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",maxWidth:"500px",margin:"0 auto"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",color:"#1F2937"},children:"競技モード選択"}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px",color:"#374151"},children:"練習モード"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[{value:"memorization",label:"暗記練習"},{value:"reaction",label:"反応練習"},{value:"competition",label:"本格競技"}].map(e=>i.jsx("button",{onClick:()=>u(e.value),style:{padding:"8px 12px",border:`2px solid ${s===e.value?"#3B82F6":"#D1D5DB"}`,borderRadius:"8px",backgroundColor:s===e.value?"#EFF6FF":"white",color:s===e.value?"#3B82F6":"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},children:e.label},e.value))})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px",color:"#374151"},children:"決まり字レベル"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},children:[1,2,3,4,5,6,"mixed"].map(e=>i.jsx("button",{onClick:()=>h(e),style:{padding:"8px 12px",border:`2px solid ${a===e?"#10B981":"#D1D5DB"}`,borderRadius:"8px",backgroundColor:a===e?"#ECFDF5":"white",color:a===e?"#10B981":"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},children:"mixed"===e?"混合":`${e}字`},e))})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px",color:"#374151"},children:"時間設定"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:[(0,i.jsxs)("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"12px",color:"#6B7280",marginBottom:"4px"},children:"暗記時間（秒）"}),i.jsx("input",{type:"number",value:d.memorizationTime,onChange:e=>p({...d,memorizationTime:parseInt(e.target.value)||15}),min:"5",max:"60",style:{width:"100%",padding:"8px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"12px",color:"#6B7280",marginBottom:"4px"},children:"制限時間（秒）"}),i.jsx("input",{type:"number",value:d.timeLimit,onChange:e=>p({...d,timeLimit:parseInt(e.target.value)||60}),min:"30",max:"300",style:{width:"100%",padding:"8px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px"}})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px",color:"#374151"},children:"判定モード"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[{value:"strict",label:"厳格"},{value:"normal",label:"通常"},{value:"lenient",label:"寛容"}].map(e=>i.jsx("button",{onClick:()=>p({...d,judgeMode:e.value}),style:{padding:"8px 12px",border:`2px solid ${d.judgeMode===e.value?"#F59E0B":"#D1D5DB"}`,borderRadius:"8px",backgroundColor:d.judgeMode===e.value?"#FFFBEB":"white",color:d.judgeMode===e.value?"#F59E0B":"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},children:e.label},e.value))})]})]})};var S=r(4001);r(3069);let j=({mode:e,onToggleMode:t})=>{let{signIn:r,signUp:n,resetPassword:o,loading:a}=(0,S.a)(),[l,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[m,g]=(0,s.useState)(null),[x,f]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),j=async t=>{if(t.preventDefault(),g(null),f(null),!l.trim()||!c.trim()){g("メールアドレスとパスワードを入力してください");return}if("signup"===e&&!h.trim()){g("氏名を入力してください");return}try{"signin"===e?await r(l,c):(await n(l,c,h),f("アカウントが作成されました"))}catch(e){console.error("Full auth error:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),g(C(e.code||e.message))}},v=async e=>{if(e.preventDefault(),g(null),f(null),!l.trim()){g("メールアドレスを入力してください");return}try{await o(l),f("パスワードリセットメールを送信しました"),b(!1)}catch(e){console.error("Reset password error:",e),g(C(e.code||e.message))}},C=e=>({"auth/invalid-email":"メールアドレスの形式が正しくありません","auth/user-disabled":"このアカウントは無効化されています","auth/user-not-found":"このメールアドレスのアカウントが見つかりません","auth/wrong-password":"パスワードが間違っています","auth/invalid-credential":"メールアドレスまたはパスワードが正しくありません","auth/too-many-requests":"ログイン試行回数が多すぎます。しばらく待ってから再試行してください","auth/popup-closed-by-user":"ログインがキャンセルされました","auth/weak-password":"パスワードは6文字以上で入力してください","auth/email-already-in-use":"このメールアドレスは既に使用されています",認証機能が無効になっています:"認証機能が無効になっています"})[e]||`エラー: ${e}`;return y?(0,i.jsxs)("div",{className:"auth-form",children:[i.jsx("h2",{children:"パスワードリセット"}),(0,i.jsxs)("form",{onSubmit:v,children:[(0,i.jsxs)("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"reset-email",children:"メールアドレス"}),i.jsx("input",{type:"email",id:"reset-email",value:l,onChange:e=>d(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),m&&i.jsx("div",{className:"error-message",children:m}),x&&i.jsx("div",{className:"success-message",children:x}),i.jsx("button",{type:"submit",disabled:a,className:"auth-button",children:a?"リセット中...":"パスワードリセット"}),i.jsx("button",{type:"button",onClick:()=>b(!1),className:"link-button",children:"ログインに戻る"})]})]}):(0,i.jsxs)("div",{className:"auth-form",children:[i.jsx("h2",{children:"signin"===e?"ログイン":"アカウント作成"}),(0,i.jsxs)("form",{onSubmit:j,children:["signup"===e&&(0,i.jsxs)("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"fullName",children:"氏名"}),i.jsx("input",{type:"text",id:"fullName",value:h,onChange:e=>p(e.target.value),placeholder:"氏名を入力",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"メールアドレス"}),i.jsx("input",{type:"email",id:"email",value:l,onChange:e=>d(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"パスワード"}),i.jsx("input",{type:"password",id:"password",value:c,onChange:e=>u(e.target.value),placeholder:"パスワードを入力（6文字以上）",minLength:6,required:!0})]}),m&&i.jsx("div",{className:"error-message",children:m}),x&&i.jsx("div",{className:"success-message",children:x}),i.jsx("button",{type:"submit",disabled:a,className:"auth-button",children:a?"signin"===e?"ログイン中...":"アカウント作成中...":"signin"===e?"ログイン":"アカウント作成"}),(0,i.jsxs)("div",{className:"auth-links",children:["signin"===e&&i.jsx("button",{type:"button",onClick:()=>b(!0),className:"link-button",children:"パスワードを忘れた方"}),i.jsx("button",{type:"button",onClick:t,className:"link-button",children:"signin"===e?"アカウントをお持ちでない方はこちら":"既にアカウントをお持ちの方はこちら"})]})]})]})};r(1184);let v=({size:e="medium"})=>i.jsx("div",{className:`loading-spinner ${e}`,children:i.jsx("div",{className:"spinner"})}),C=({children:e,requireAuth:t})=>{let{user:r,loading:s,isAuthEnabled:o}=(0,S.a)(),[a,l]=n().useState("signin");return o&&t?s?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"40px",borderRadius:"12px",textAlign:"center"},children:[i.jsx(v,{}),i.jsx("p",{style:{marginTop:"16px",color:"#666"},children:"認証状態を確認中..."})]})}):r?i.jsx(i.Fragment,{children:e}):i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",maxWidth:"450px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[(0,i.jsxs)("div",{style:{padding:"24px",textAlign:"center"},children:[i.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"8px",color:"#1F2937"},children:"ログインが必要です"}),i.jsx("p",{style:{color:"#6B7280",fontSize:"14px",marginBottom:"24px"},children:"この機能を使用するにはログインしてください"})]}),i.jsx(j,{mode:a,onToggleMode:()=>l("signin"===a?"signup":"signin")})]})}):i.jsx(i.Fragment,{children:e})},w=()=>{let{user:e,isLoggedIn:t,signOut:r,isAuthEnabled:n}=(0,S.a)(),[o,a]=(0,s.useState)(!1),[l,d]=(0,s.useState)("signin");if(!n)return null;let c=async()=>{try{await r()}catch(e){console.error("ログアウトエラー:",e)}};return t&&e?(0,i.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",backgroundColor:"#f3f4f6",borderRadius:"8px"},children:[e.photoURL&&i.jsx("img",{src:e.photoURL,alt:"プロフィール",style:{width:"24px",height:"24px",borderRadius:"50%",objectFit:"cover"}}),i.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#374151"},children:e.displayName||e.email})]}),i.jsx("button",{onClick:c,style:{padding:"8px 16px",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#dc2626",onMouseOut:e=>e.currentTarget.style.backgroundColor="#ef4444",children:"ログアウト"})]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("button",{onClick:()=>a(!0),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#2563eb",onMouseOut:e=>e.currentTarget.style.backgroundColor="#3b82f6",children:"ログイン"}),o&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",maxWidth:"450px",width:"90%",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[i.jsx("button",{onClick:()=>a(!1),style:{position:"absolute",top:"16px",right:"16px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#f3f4f6",onMouseOut:e=>e.currentTarget.style.backgroundColor="transparent",children:"\xd7"}),i.jsx("div",{style:{padding:"24px"},children:i.jsx(j,{mode:l,onToggleMode:()=>d("signin"===l?"signup":"signin")})})]})})]})};function k(){let{user:e,isLoggedIn:t}=(0,S.a)(),[r,n]=(0,s.useState)([]),[d,c]=(0,s.useState)([]),[p,m]=(0,s.useState)(1),[f,j]=(0,s.useState)(new Set),[v,k]=(0,s.useState)(!1),[A,T]=(0,s.useState)(0),[z,R]=(0,s.useState)(!1),[M,F]=(0,s.useState)(10),I=e=>{let t;if(F(e),"all"===H)t=o.g.filter(e=>!l.t.isMemorized(e.id));else{let e=x(H);t=l.t.getUnmemorizedCardsByKimarijiLength(o.g,e)}c(t.slice(0,e))},P=e=>{let t;if(N(e),console.log(`フィルター: ${e}字決まりを選択`),console.log("全カード数:",r.length),"all"===e)t=r.filter(e=>!l.t.isMemorized(e.id));else{let r=x(e);console.log(`${e}字決まりの札ID:`,r),t=l.t.getUnmemorizedCardsByKimarijiLength(o.g,r)}console.log("フィルタリング後のカード数:",t.length),c(t.slice(0,M))},[B,D]=(0,s.useState)(!1),[W,E]=(0,s.useState)(!1),[H,N]=(0,s.useState)("all"),[O,L]=(0,s.useState)(!1),[K,q]=(0,s.useState)("oneChar"),[_,U]=(0,s.useState)(!1),[J,Y]=(0,s.useState)("memorization"),[$,G]=(0,s.useState)("mixed"),[V,X]=(0,s.useState)({timeLimit:60,memorizationTime:15,judgeMode:"normal"});a.b.getInstance();let Z=u.getInstance(),Q=h.getInstance(),ee=e=>{j(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},et=e=>{if(l.t.toggleMemorized(e),T(l.t.getMemorizedCount()),l.t.isMemorized(e)){let t=d.filter(t=>t.id!==e);c(t);let r=o.g.filter(e=>!t.some(t=>t.id===e.id)&&!l.t.isMemorized(e.id));if(r.length>0&&t.length<M){let e;if("all"===H)e=r;else{let t=x(H);e=r.filter(e=>t.includes(e.id))}if(e.length>0){let r=e[0];r&&c([...t,r])}}}},er=()=>{if("mixed"===$)return o.g.slice(0,20);{let e=x($);return o.g.filter(t=>e.includes(t.id))}};return z?_&&"setup"===Z.getCurrentState().currentPhase?i.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%)",padding:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{maxWidth:"600px",width:"100%"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"24px",color:"#1F2937",fontSize:"24px",fontWeight:"600"},children:"競技トレーニングモード"}),i.jsx(b,{onModeSelect:Y,onKimarijiLevelSelect:G,onSettingsChange:X}),(0,i.jsxs)("div",{style:{marginTop:"24px",display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{U(!0),Z.startSession(J,$,V),c(er()),j(new Set)},style:{backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"開始"}),i.jsx("button",{onClick:()=>U(!1),style:{backgroundColor:"#6B7280",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"キャンセル"})]})]})}):(0,i.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%)",padding:"16px",position:"relative"},children:[i.jsx("header",{style:{marginBottom:"24px"},children:(0,i.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:"0",right:"0",zIndex:10},children:i.jsx(w,{})}),i.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1f2937",textAlign:"center",marginBottom:"16px",paddingTop:"8px"},children:"百人一首トレーニング"}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px"},children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",display:"flex"},children:[i.jsx("button",{onClick:()=>{L(!1),U(!1)},style:{backgroundColor:O||_?"transparent":"#3b82f6",color:O||_?"#6b7280":"white",padding:"8px 16px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:O||_?"400":"600"},children:"通常モード"}),(0,i.jsxs)("button",{onClick:()=>{t&&(L(!0),U(!1))},disabled:!t,title:t?"":"ログインが必要です",style:{backgroundColor:O&&!_?"#3b82f6":"transparent",color:t?O&&!_?"white":"#6b7280":"#9ca3af",padding:"8px 16px",borderRadius:"4px",border:"none",cursor:t?"pointer":"not-allowed",fontSize:"14px",fontWeight:O&&!_?"600":"400",opacity:t?1:.5,transition:"all 0.2s ease",position:"relative"},children:["トレーニングモード",!t&&i.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",width:"8px",height:"8px",backgroundColor:"#ef4444",borderRadius:"50%",fontSize:"10px",color:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:"\uD83D\uDD12"})]}),(0,i.jsxs)("button",{onClick:()=>{t&&(L(!1),U(!0))},disabled:!t,title:t?"":"ログインが必要です",style:{backgroundColor:_?"#10b981":"transparent",color:t?_?"white":"#6b7280":"#9ca3af",padding:"8px 16px",borderRadius:"4px",border:"none",cursor:t?"pointer":"not-allowed",fontSize:"14px",fontWeight:_?"600":"400",opacity:t?1:.5,transition:"all 0.2s ease",position:"relative"},children:["競技モード",!t&&i.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",width:"8px",height:"8px",backgroundColor:"#ef4444",borderRadius:"50%",fontSize:"10px",color:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:"\uD83D\uDD12"})]})]})}),!O&&!_&&i.jsx("div",{style:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"16px",marginBottom:"16px"},children:(0,i.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:"16px"},children:[(0,i.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px",fontSize:"0.875rem"},children:[i.jsx("span",{style:{backgroundColor:"#93c5fd",color:"white",padding:"8px 12px",borderRadius:"9999px",display:"inline-flex",alignItems:"center",justifyContent:"center",minHeight:"32px",lineHeight:"1"},children:"デバイス: PC"}),(0,i.jsxs)("div",{style:{backgroundColor:"#86efac",color:"white",padding:"8px 12px",borderRadius:"9999px",display:"inline-flex",alignItems:"center",justifyContent:"center",minHeight:"32px",lineHeight:"1",gap:"8px"},children:["表示:",(0,i.jsxs)("select",{value:M,onChange:e=>I(Number(e.target.value)),style:{backgroundColor:"white",color:"#166534",border:"none",borderRadius:"4px",padding:"2px 4px",fontSize:"0.875rem",cursor:"pointer"},children:[i.jsx("option",{value:5,children:"5枚"}),i.jsx("option",{value:10,children:"10枚"}),i.jsx("option",{value:15,children:"15枚"}),i.jsx("option",{value:20,children:"20枚"})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#c4b5fd",color:"white",padding:"8px 12px",borderRadius:"9999px",display:"inline-flex",alignItems:"center",justifyContent:"center",minHeight:"32px",lineHeight:"1",gap:"8px"},children:["覚えた: ",A,"/",o.g.length,"首",A>0&&i.jsx("button",{onClick:()=>{let e;if(o.g.forEach(e=>{l.t.isMemorized(e.id)&&l.t.toggleMemorized(e.id)}),T(0),"all"===H)e=o.g;else{let t=x(H);e=o.g.filter(e=>t.includes(e.id))}c(e.slice(0,M)),j(new Set)},style:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",padding:"2px 6px",fontSize:"0.75rem",cursor:"pointer",lineHeight:"1"},children:"リセット"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{let e;let t=[...o.g].sort(()=>Math.random()-.5);if(n(t),"all"===H)e=t.filter(e=>!l.t.isMemorized(e.id));else{let r=x(H);e=l.t.getUnmemorizedCardsByKimarijiLength(t,r)}c(e.slice(0,M)),j(new Set)},style:{backgroundColor:"#3b82f6",color:"white",padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px"},children:"シャッフル"}),(0,i.jsxs)("button",{onClick:()=>D(!B),style:{backgroundColor:B?"#f59e0b":"#e5e7eb",color:B?"white":"#374151",padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px"},children:["決まり字 ",B?"ON":"OFF"]}),(0,i.jsxs)("button",{onClick:()=>E(!W),style:{backgroundColor:W?"#10b981":"#e5e7eb",color:W?"white":"#374151",padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px"},children:["ひらがな ",W?"ON":"OFF"]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f3f4f6",padding:"8px 12px",borderRadius:"6px"},children:[i.jsx("span",{style:{fontSize:"14px",color:"#374151"},children:"決まり字数:"}),(0,i.jsxs)("select",{value:H,onChange:e=>P(e.target.value),style:{backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"4px",padding:"4px 8px",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"all",children:"全て"}),i.jsx("option",{value:1,children:"1字"}),i.jsx("option",{value:2,children:"2字"}),i.jsx("option",{value:3,children:"3字"}),i.jsx("option",{value:4,children:"4字"}),i.jsx("option",{value:5,children:"5字"}),i.jsx("option",{value:6,children:"6字"})]})]})]})]})})]})}),i.jsx("main",{style:{maxWidth:"1200px",margin:"0 auto"},children:_?i.jsx(C,{requireAuth:!0,children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"24px",textAlign:"center"},children:[i.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#1f2937",marginBottom:"24px"},children:"競技トレーニングモード"}),i.jsx("div",{style:{marginBottom:"24px"},children:i.jsx(y,{timeRemaining:Z.getCurrentState().timeRemaining,totalTime:V.timeLimit,phase:Z.getCurrentState().currentPhase})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#f3f4f6",padding:"12px 16px",borderRadius:"8px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:Z.getCurrentState().sessionStats.correctAnswers}),i.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"正解"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f3f4f6",padding:"12px 16px",borderRadius:"8px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:Z.getCurrentState().sessionStats.totalAttempts}),i.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"試行"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f3f4f6",padding:"12px 16px",borderRadius:"8px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:Z.getCurrentState().sessionStats.currentStreak}),i.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"連続"})]})]}),i.jsx("button",{onClick:()=>{let e=Z.endSession();e&&Q.updateSessionHistory(e),U(!1)},style:{backgroundColor:"#dc2626",color:"white",padding:"12px 24px",borderRadius:"8px",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"競技終了"})]})}):O?i.jsx(C,{requireAuth:!0,children:(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"24px"},children:[i.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#1f2937",marginBottom:"24px",textAlign:"center"},children:"基礎トレーニング"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:[(0,i.jsxs)("div",{onClick:()=>q("oneChar"),style:{backgroundColor:"oneChar"===K?"#e0f2fe":"#f8fafc",border:"oneChar"===K?"2px solid #0284c7":"2px solid #e2e8f0",borderRadius:"8px",padding:"20px",cursor:"pointer",transition:"all 0.2s ease"},children:[i.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937",marginBottom:"8px"},children:"1字決まり練習"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"8px"},children:"最も覚えやすい1字で決まる札から開始"}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#059669",fontWeight:"500"},children:"推奨: 初心者"})]}),(0,i.jsxs)("div",{onClick:()=>q("twoChar"),style:{backgroundColor:"twoChar"===K?"#e0f2fe":"#f8fafc",border:"twoChar"===K?"2px solid #0284c7":"2px solid #e2e8f0",borderRadius:"8px",padding:"20px",cursor:"pointer",transition:"all 0.2s ease"},children:[i.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937",marginBottom:"8px"},children:"2字決まり練習"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"8px"},children:"標準的な2字で決まる札の習得"}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#d97706",fontWeight:"500"},children:"推奨: 中級者"})]}),(0,i.jsxs)("div",{onClick:()=>q("threeChar"),style:{backgroundColor:"threeChar"===K?"#e0f2fe":"#f8fafc",border:"threeChar"===K?"2px solid #0284c7":"2px solid #e2e8f0",borderRadius:"8px",padding:"20px",cursor:"pointer",transition:"all 0.2s ease"},children:[i.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937",marginBottom:"8px"},children:"3字以上決まり練習"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"8px"},children:"難しい決まり字の上級練習"}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#dc2626",fontWeight:"500"},children:"推奨: 上級者"})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f1f5f9",borderRadius:"8px",padding:"20px",border:"1px solid #e2e8f0"},children:[(0,i.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937",marginBottom:"12px"},children:["oneChar"===K&&"1字決まり練習","twoChar"===K&&"2字決まり練習","threeChar"===K&&"3字以上決まり練習"]}),(0,i.jsxs)("p",{style:{color:"#6b7280",marginBottom:"16px"},children:["oneChar"===K&&"「む・す・め・ふ・さ・ほ・せ」の7首を完全習得するまで反復練習します。","twoChar"===K&&"2字で決まる札を段階的に習得します。最も一般的な決まり字パターンです。","threeChar"===K&&"3字以上で決まる札の習得です。上級者向けの難しい決まり字です。"]}),i.jsx("button",{onClick:()=>{L(!1),"oneChar"===K?P(1):"twoChar"===K?P(2):"threeChar"===K&&P(3)},style:{backgroundColor:"#3b82f6",color:"white",padding:"12px 24px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"練習開始"})]})]})}):0===d.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"48px 0"},children:[i.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#374151",marginBottom:"16px"},children:"すべての句を覚えました！"}),i.jsx("p",{style:{color:"#6b7280"},children:"復習モードに切り替えて復習することができます。"})]}):i.jsx(i.Fragment,{children:i.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"12px",maxWidth:"1200px",margin:"0 auto"},children:d.map(e=>(0,i.jsxs)("div",{onClick:()=>ee(e.id),style:{backgroundColor:"#f8f6f0",borderRadius:"4px",cursor:"pointer",position:"relative",transition:"all 0.3s ease",aspectRatio:"1 / 1.1",width:"220px",flexShrink:0},children:[i.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",fontSize:"0.75rem",color:"#6b7280",backgroundColor:"#f3f4f6",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.id}),i.jsx("button",{onClick:t=>{t.stopPropagation(),et(e.id)},style:{position:"absolute",top:"8px",right:"8px",width:"24px",height:"24px",borderRadius:"50%",fontSize:"0.75rem",backgroundColor:l.t.isMemorized(e.id)?"#10b981":"#e5e7eb",color:l.t.isMemorized(e.id)?"white":"#6b7280",border:"none",cursor:"pointer"},children:"✓"}),f.has(e.id)?(0,i.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"180px",padding:"12px",position:"relative"},children:[i.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 6px"},children:i.jsx("div",{style:{writingMode:"vertical-rl",textOrientation:"upright",direction:"rtl",fontSize:"1.1rem",lineHeight:"1.8",textAlign:"center",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:'"Noto Serif JP", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", serif',fontWeight:"700",color:"#1a1a1a",letterSpacing:"0.03em",whiteSpace:"pre-line"},children:W?e.reading.shimoNoKu.replace(/\s+/g,"\n"):e.shimoNoKu.replace(/\s+/g,"\n")})}),B&&e.kimariji&&i.jsx("div",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px",display:"flex",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{fontSize:"0.6rem",backgroundColor:"#fff7e6",color:"#b45309",padding:"3px 4px",borderRadius:"2px",fontFamily:'"Noto Serif JP", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", serif',fontWeight:"700",border:"1px solid #f3d19e",display:"flex",alignItems:"center",justifyContent:"center"},children:["決まり字：",g(e.id)?.pattern||e.reading.kamiNoKu.replace(/\s+/g,"").substring(e.kimariji.position,e.kimariji.position+e.kimariji.length)]})}),i.jsx("div",{style:{fontSize:"0.7rem",color:"#444444",textAlign:"center",position:"absolute",bottom:"8px",left:"50%",transform:"translateX(-50%)",fontFamily:'"Noto Serif JP", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", serif',fontWeight:"500",letterSpacing:"0.05em",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap"},children:e.author})]}):(0,i.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"180px",padding:"12px",position:"relative"},children:[i.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 6px"},children:i.jsx("div",{style:{writingMode:"vertical-rl",textOrientation:"upright",direction:"rtl",fontSize:"1.1rem",lineHeight:"1.8",textAlign:"center",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:'"Noto Serif JP", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", serif',fontWeight:"700",color:"#1a1a1a",letterSpacing:"0.03em",whiteSpace:"pre-line"},children:W?e.reading.kamiNoKu.replace(/\s+/g,"\n"):e.kamiNoKu.replace(/\s+/g,"\n")})}),B&&e.kimariji&&i.jsx("div",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px",display:"flex",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{fontSize:"0.6rem",backgroundColor:"#fff7e6",color:"#b45309",padding:"3px 4px",borderRadius:"2px",fontFamily:'"Noto Serif JP", "Hiragino Mincho ProN", "Yu Mincho", "YuMincho", serif',fontWeight:"700",border:"1px solid #f3d19e",display:"flex",alignItems:"center",justifyContent:"center"},children:["決まり字：",g(e.id)?.pattern||e.reading.kamiNoKu.replace(/\s+/g,"").substring(e.kimariji.position,e.kimariji.position+e.kimariji.length)]})})]})]},e.id))})})}),i.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]}):i.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #f3f4f6",borderTop:"4px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),i.jsx("p",{style:{color:"#6b7280"},children:"百人一首データを読み込み中..."})]})})}function A(){return i.jsx(S.H,{children:i.jsx(k,{})})}},4001:(e,t,r)=>{"use strict";r.d(t,{H:()=>d,a:()=>l});var i=r(326),s=r(7577),n=r(8108),o=r(445);new Date().toISOString(),new Date().toISOString(),()=>({});let a=(0,s.createContext)(void 0),l=()=>{let e=(0,s.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},d=({children:e})=>{let[t,r]=(0,s.useState)(null),[l,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>(console.log("AuthProvider - AUTH_ENABLED:",!0),console.log("AuthProvider - Environment:","production"),(0,n.Aj)(o.I,e=>{console.log("AuthProvider - Auth state changed:",{uid:e?.uid,email:e?.email,emailVerified:e?.emailVerified,isAnonymous:e?.isAnonymous}),r(e),d(!1)})),[]);let c=async(e,t,r)=>{try{let i=await (0,n.Xb)(o.I,e,t);await (0,n.ck)(i.user,{displayName:r})}catch(e){throw e}},u=async(e,t)=>{try{console.log("AuthProvider - Signing in with email:",e);let r=await (0,n.e5)(o.I,e,t);console.log("AuthProvider - User signed in successfully:",{uid:r.user.uid,email:r.user.email,emailVerified:r.user.emailVerified})}catch(e){throw console.error("Sign in error:",e),e}},h=async()=>{try{await (0,n.w7)(o.I)}catch(e){throw e}},p=async e=>{try{await (0,n.LS)(o.I,e)}catch(e){throw e}},m={user:t,loading:l,isLoggedIn:null!==t&&!t.isAnonymous,signUp:c,signIn:u,signOut:h,resetPassword:p,isAuthEnabled:!0};return i.jsx(a.Provider,{value:m,children:e})}},445:(e,t,r)=>{"use strict";r.d(t,{I:()=>a,db:()=>l});var i=r(2585),s=r(8108),n=r(76);let o=(0,i.ZF)({apiKey:"AIzaSyBJSobP7SJjT0kLDKx7cIrq2uCeTlKs978",authDomain:"meku-run.firebaseapp.com",projectId:"meku-run",storageBucket:"meku-run.firebasestorage.app",messagingSenderId:"762843174518",appId:"1:762843174518:web:7057c9553148b56719b157"}),a=(0,s.v0)(o),l=(0,n.ad)(o)},7259:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});class i{static{this.STORAGE_KEY="hyakunin-isshu-memorized-cards"}constructor(){this.memorizedCardIds=new Set}loadFromStorage(){try{let e=localStorage.getItem(i.STORAGE_KEY);if(e){let t=JSON.parse(e);this.memorizedCardIds=new Set(t)}}catch(e){console.warn("覚えたカードの読み込みに失敗しました:",e),this.memorizedCardIds=new Set}}saveToStorage(){}markAsMemorized(e){this.memorizedCardIds.add(e),this.saveToStorage()}unmarkAsMemorized(e){this.memorizedCardIds.delete(e),this.saveToStorage()}isMemorized(e){return this.memorizedCardIds.has(e)}toggleMemorized(e){return this.isMemorized(e)?(this.unmarkAsMemorized(e),!1):(this.markAsMemorized(e),!0)}getMemorizedCardIds(){return Array.from(this.memorizedCardIds).sort((e,t)=>e-t)}getMemorizedCount(){return this.memorizedCardIds.size}filterUnmemorizedCards(e){return e.filter(e=>!this.isMemorized(e.id))}getUnmemorizedCardsByKimarijiLength(e,t){return e.filter(e=>t.includes(e.id)&&!this.isMemorized(e.id))}filterMemorizedCards(e){return e.filter(e=>this.isMemorized(e.id))}clearAllMemorized(){this.memorizedCardIds.clear(),this.saveToStorage()}getStatistics(e){let t=this.getMemorizedCount();return{memorizedCount:t,remainingCount:e-t,completionRate:e>0?t/e*100:0}}}let s=new i},9678:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});class i{constructor(){this.allCards=[]}static getInstance(){return i.instance||(i.instance=new i),i.instance}setAllCards(e){this.allCards=e}getOptimalCardCount(e){return({smartphone:2,tablet:12,desktop:50})[e]}getAvailableCardSets(){return[{id:"smartphone-basic",name:"基礎練習セット",description:"2枚での基本的な練習",cardCount:2,difficulty:"beginner",deviceType:"smartphone",recommendedForBeginners:!0},{id:"tablet-intermediate",name:"中級練習セット",description:"12枚での中級レベル練習",cardCount:12,difficulty:"intermediate",deviceType:"tablet",recommendedForBeginners:!1},{id:"desktop-advanced",name:"上級練習セット",description:"50枚での本格的な練習",cardCount:50,difficulty:"advanced",deviceType:"desktop",recommendedForBeginners:!1}]}generateCardSet(e){let t=[...this.allCards];if(e.kimarijiFilter){let{minLength:r,maxLength:i}=e.kimarijiFilter;t=t.filter(e=>{let t=e.kimariji?.length||0;return t>=r&&t<=i})}t=this.filterByDifficulty(t,e.difficulty);let r=this.selectCards(t,e.cardCount);return e.shuffleMode&&(r=this.shuffleCards(r)),r}filterByDifficulty(e,t){switch(t){case"beginner":return e.filter(e=>2>=(e.kimariji?.length||0));case"intermediate":return e.filter(e=>{let t=e.kimariji?.length||0;return t>=2&&t<=4});default:return e}}selectCards(e,t){if(e.length<=t)return e;let r=[],i=this.groupByKimarijiLength(e),s=Object.keys(i).sort(),n=Math.floor(t/s.length),o=t;if(s.forEach(e=>{let t=i[e];if(!t||!Array.isArray(t))return;let s=Math.min(n,o,t.length),a=this.shuffleCards([...t]);r.push(...a.slice(0,s)),o-=s}),o>0){let t=new Set(r.map(e=>e.id)),i=e.filter(e=>!t.has(e.id)),s=this.shuffleCards(i);r.push(...s.slice(0,o))}return r}groupByKimarijiLength(e){let t={};return e.forEach(e=>{let r=e.kimariji?.length||0,i=`${r}字決まり`;t[i]||(t[i]=[]),t[i].push(e)}),t}shuffleCards(e){let t=[...e];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1)),i=t[e],s=t[r];i&&s&&(t[e]=s,t[r]=i)}return t}getCardSetStats(e){let t;let r={},i=0;e.forEach(e=>{let t=e.kimariji?.length||0,s=`${t}字決まり`;r[s]=(r[s]||0)+1,i+=t});let s=i/e.length;return t=s<=2?"beginner":s<=3.5?"intermediate":"advanced",{totalCards:e.length,kimarijiDistribution:r,averageKimarijiLength:s,difficultyLevel:t}}getRecommendedSet(e,t){let r=this.getOptimalCardCount(e);return this.generateCardSet({deviceType:e,cardCount:r,difficulty:t,includeMemorized:!1,shuffleMode:!0})}generateWeakCardsSet(e,t){let r=this.getOptimalCardCount(e),i=this.allCards.filter(e=>t.includes(e.id)),s=Math.min(i.length,Math.floor(.7*r)),n=this.allCards.filter(e=>!t.includes(e.id)),o=this.shuffleCards(n);return[...this.shuffleCards(i).slice(0,s),...o.slice(0,r-s)]}generateReviewSet(e,t){let r=this.getOptimalCardCount(e),i=this.allCards.filter(e=>t.includes(e.id));if(0===i.length)return[];let s=this.shuffleCards(i);return s.slice(0,Math.min(r,s.length))}}i.getInstance()},908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(8570).createProxy)(String.raw`/workspace/firebase-word-card-app/app/page.tsx#default`)},3069:()=>{},1184:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[819,134,324],()=>r(1230));module.exports=i})();