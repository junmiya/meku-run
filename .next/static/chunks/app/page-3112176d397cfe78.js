(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7636:function(e,a,t){Promise.resolve().then(t.bind(t,4552))},4552:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var r=t(7437),s=t(2265),n=t(6281);t(1030);var i=e=>{let{mode:a,onToggleMode:t}=e,{signIn:i,signUp:l,signInWithGoogle:o,resetPassword:d,loading:c}=(0,n.a)(),[u,g]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),[p,f]=(0,s.useState)(""),[x,v]=(0,s.useState)(null),[w,C]=(0,s.useState)(null),[j,b]=(0,s.useState)(!1),y=async e=>{if(e.preventDefault(),v(null),C(null),!u.trim()||!h.trim()){v("メールアドレスとパスワードを入力してください");return}if("signup"===a&&!p.trim()){v("氏名を入力してください");return}try{let e;(e="signin"===a?await i(u,h):await l(u,h,{data:{full_name:p}})).error?v(N(e.error.message)):"signup"===a&&e.data.user&&!e.data.session&&C("確認メールを送信しました。メールをチェックして、アカウントを有効化してください。")}catch(e){v("予期しないエラーが発生しました"),console.error("Auth error:",e)}},E=async e=>{if(e.preventDefault(),v(null),C(null),!u.trim()){v("メールアドレスを入力してください");return}try{let e=await d(u);e.error?v(N(e.error.message)):(C("パスワードリセットメールを送信しました"),b(!1))}catch(e){v("予期しないエラーが発生しました"),console.error("Reset password error:",e)}},S=async()=>{try{v(null),console.log("Starting Google OAuth...");let e=await o();console.log("Google OAuth result:",e),e.error?(console.error("Google OAuth error:",e.error),v(N(e.error.message))):e.data.url?(console.log("Redirecting to Google OAuth URL:",e.data.url),window.open(e.data.url,"_self")):(console.log("No URL returned from Google OAuth"),v("Google認証URLの取得に失敗しました"))}catch(e){console.error("Google auth error:",e),v("Google認証でエラーが発生しました")}},N=e=>({"Invalid login credentials":"メールアドレスまたはパスワードが正しくありません","Email not confirmed":"メールアドレスが確認されていません","User already registered":"このメールアドレスは既に登録されています","Password should be at least 6 characters":"パスワードは6文字以上で入力してください","Invalid email":"メールアドレスの形式が正しくありません"})[e]||"エラー: ".concat(e);return j?(0,r.jsxs)("div",{className:"auth-form",children:[(0,r.jsx)("h2",{children:"パスワードリセット"}),(0,r.jsxs)("form",{onSubmit:E,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"reset-email",children:"メールアドレス"}),(0,r.jsx)("input",{type:"email",id:"reset-email",value:u,onChange:e=>g(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),x&&(0,r.jsx)("div",{className:"error-message",children:x}),w&&(0,r.jsx)("div",{className:"success-message",children:w}),(0,r.jsx)("button",{type:"submit",disabled:c,className:"auth-button",children:c?"リセット中...":"パスワードリセット"}),(0,r.jsx)("button",{type:"button",onClick:()=>b(!1),className:"link-button",children:"ログインに戻る"})]})]}):(0,r.jsxs)("div",{className:"auth-form",children:[(0,r.jsx)("h2",{children:"signin"===a?"ログイン":"アカウント作成"}),(0,r.jsx)("div",{className:"google-auth-section",children:(0,r.jsxs)("button",{type:"button",onClick:S,disabled:c,className:"google-signin-button",children:[(0,r.jsxs)("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"20",height:"20",children:[(0,r.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,r.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,r.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,r.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Googleで","signin"===a?"ログイン":"登録"]})}),(0,r.jsx)("div",{className:"divider",children:(0,r.jsx)("span",{children:"または"})}),(0,r.jsxs)("form",{onSubmit:y,children:["signup"===a&&(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"fullName",children:"氏名"}),(0,r.jsx)("input",{type:"text",id:"fullName",value:p,onChange:e=>f(e.target.value),placeholder:"氏名を入力",required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"email",children:"メールアドレス"}),(0,r.jsx)("input",{type:"email",id:"email",value:u,onChange:e=>g(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"password",children:"パスワード"}),(0,r.jsx)("input",{type:"password",id:"password",value:h,onChange:e=>m(e.target.value),placeholder:"パスワードを入力（6文字以上）",minLength:6,required:!0})]}),x&&(0,r.jsx)("div",{className:"error-message",children:x}),w&&(0,r.jsx)("div",{className:"success-message",children:w}),(0,r.jsx)("button",{type:"submit",disabled:c,className:"auth-button",children:c?"signin"===a?"ログイン中...":"アカウント作成中...":"signin"===a?"ログイン":"アカウント作成"}),(0,r.jsxs)("div",{className:"auth-links",children:["signin"===a&&(0,r.jsx)("button",{type:"button",onClick:()=>b(!0),className:"link-button",children:"パスワードを忘れた方"}),(0,r.jsx)("button",{type:"button",onClick:t,className:"link-button",children:"signin"===a?"アカウントをお持ちでない方はこちら":"既にアカウントをお持ちの方はこちら"})]})]})]})};t(6810);var l=e=>{var a,t,i,l,o;let{onClose:d}=e,{user:c,signOut:u}=(0,n.a)(),[g,h]=(0,s.useState)(!1),m=async()=>{h(!0);try{await u()}catch(e){console.error("Sign out error:",e),h(!1)}};return c?(0,r.jsx)("div",{className:"user-profile-overlay",children:(0,r.jsxs)("div",{className:"user-profile",children:[(0,r.jsxs)("div",{className:"profile-header",children:[(0,r.jsx)("h3",{children:"プロフィール"}),(0,r.jsx)("button",{onClick:d,className:"close-button",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"profile-content",children:[(0,r.jsxs)("div",{className:"profile-info",children:[(0,r.jsx)("div",{className:"avatar",children:(null===(a=c.user_metadata)||void 0===a?void 0:a.avatar_url)?(0,r.jsx)("img",{src:c.user_metadata.avatar_url,alt:"Avatar"}):(0,r.jsx)("div",{className:"avatar-placeholder",children:(null===(i=c.user_metadata)||void 0===i?void 0:null===(t=i.full_name)||void 0===t?void 0:t.charAt(0))||(null===(l=c.email)||void 0===l?void 0:l.charAt(0))||"?"})}),(0,r.jsxs)("div",{className:"user-details",children:[(0,r.jsx)("p",{className:"user-name",children:(null===(o=c.user_metadata)||void 0===o?void 0:o.full_name)||"ユーザー"}),(0,r.jsx)("p",{className:"user-email",children:c.email})]})]}),(0,r.jsxs)("div",{className:"profile-stats",children:[(0,r.jsxs)("div",{className:"stat",children:[(0,r.jsx)("span",{className:"stat-label",children:"アカウント作成日"}),(0,r.jsx)("span",{className:"stat-value",children:new Date(c.created_at).toLocaleDateString("ja-JP")})]}),(0,r.jsxs)("div",{className:"stat",children:[(0,r.jsx)("span",{className:"stat-label",children:"最終ログイン"}),(0,r.jsx)("span",{className:"stat-value",children:c.last_sign_in_at?new Date(c.last_sign_in_at).toLocaleDateString("ja-JP"):"不明"})]})]}),(0,r.jsx)("div",{className:"profile-actions",children:(0,r.jsx)("button",{onClick:m,disabled:g,className:"signout-button",children:g?"ログアウト中...":"ログアウト"})})]})]})}):null},o=t(1968);t(3190);var d=e=>{let{card:a,onEdit:t,onDelete:n,onToggleStar:i}=e,[l,o]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"card-container",children:[(0,r.jsxs)("div",{className:"card ".concat(l?"flipped":""),onClick:()=>{o(!l)},children:[(0,r.jsx)("div",{className:"card-face front",children:(0,r.jsxs)("div",{className:"card-content",children:[(0,r.jsx)("h3",{children:a.word}),a.tags&&a.tags.length>0&&(0,r.jsx)("div",{className:"tags",children:a.tags.map((e,a)=>(0,r.jsx)("span",{className:"tag",children:e},a))})]})}),(0,r.jsx)("div",{className:"card-face back",children:(0,r.jsx)("div",{className:"card-content",children:(0,r.jsx)("p",{children:a.meaning})})})]}),(0,r.jsxs)("div",{className:"card-actions",children:[(0,r.jsx)("button",{className:"star-btn ".concat(a.isStarred?"starred":""),onClick:e=>{e.stopPropagation(),null==i||i(a.id)},children:"★"}),(0,r.jsx)("button",{className:"edit-btn",onClick:e=>{e.stopPropagation(),null==t||t(a)},children:"編集"}),(0,r.jsx)("button",{className:"delete-btn",onClick:e=>{e.stopPropagation(),null==n||n(a.id)},children:"削除"})]})]})};t(6428);var c=e=>{let{card:a,onSave:t,onCancel:n}=e,[i,l]=(0,s.useState)(""),[o,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[g,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(a){var e;l(a.word),d(a.meaning),u((null===(e=a.tags)||void 0===e?void 0:e.join(", "))||""),h(a.isStarred||!1)}},[a]),(0,r.jsx)("div",{className:"card-form-overlay",children:(0,r.jsxs)("div",{className:"card-form",children:[(0,r.jsx)("h2",{children:a?"単語カードを編集":"新しい単語カードを作成"}),(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!i.trim()||!o.trim()){alert("単語と意味を入力してください");return}let a=c.split(",").map(e=>e.trim()).filter(e=>e.length>0);t({word:i.trim(),meaning:o.trim(),isStarred:g,...a.length>0&&{tags:a}}),l(""),d(""),u(""),h(!1)},children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"word",children:"単語"}),(0,r.jsx)("input",{type:"text",id:"word",value:i,onChange:e=>l(e.target.value),placeholder:"単語を入力",required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"meaning",children:"意味"}),(0,r.jsx)("textarea",{id:"meaning",value:o,onChange:e=>d(e.target.value),placeholder:"意味を入力",rows:3,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"tags",children:"タグ（カンマ区切り）"}),(0,r.jsx)("input",{type:"text",id:"tags",value:c,onChange:e=>u(e.target.value),placeholder:"タグ1, タグ2, タグ3"})]}),(0,r.jsx)("div",{className:"form-group checkbox-group",children:(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"checkbox",checked:g,onChange:e=>h(e.target.checked)}),"お気に入り"]})}),(0,r.jsxs)("div",{className:"form-actions",children:[(0,r.jsx)("button",{type:"button",onClick:n,className:"cancel-btn",children:"キャンセル"}),(0,r.jsx)("button",{type:"submit",className:"save-btn",children:a?"更新":"保存"})]})]})]})})};t(9141);var u=e=>{let{searchQuery:a,onSearchChange:t,sortBy:s,onSortByChange:n,sortOrder:i,onSortOrderChange:l,showStarredOnly:o,onShowStarredOnlyChange:d,selectedTag:c,onSelectedTagChange:u,availableTags:g,totalCards:h,filteredCards:m}=e;return(0,r.jsxs)("div",{className:"search-filter",children:[(0,r.jsx)("div",{className:"search-section",children:(0,r.jsxs)("div",{className:"search-input-container",children:[(0,r.jsx)("input",{type:"text",placeholder:"単語や意味で検索...",value:a,onChange:e=>t(e.target.value),className:"search-input"}),a&&(0,r.jsx)("button",{className:"clear-search",onClick:()=>t(""),children:"\xd7"})]})}),(0,r.jsxs)("div",{className:"filter-section",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"並び順:"}),(0,r.jsxs)("select",{value:s,onChange:e=>n(e.target.value),className:"filter-select",children:[(0,r.jsx)("option",{value:"createdAt",children:"作成日"}),(0,r.jsx)("option",{value:"updatedAt",children:"更新日"}),(0,r.jsx)("option",{value:"alphabetical",children:"アルファベット順"})]}),(0,r.jsx)("button",{className:"sort-order-btn ".concat("desc"===i?"desc":"asc"),onClick:()=>l("asc"===i?"desc":"asc"),title:"asc"===i?"昇順":"降順",children:"asc"===i?"↑":"↓"})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"タグ:"}),(0,r.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"filter-select",children:[(0,r.jsx)("option",{value:"",children:"すべて"}),g.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsx)("div",{className:"filter-group",children:(0,r.jsxs)("label",{className:"checkbox-label",children:[(0,r.jsx)("input",{type:"checkbox",checked:o,onChange:e=>d(e.target.checked)}),"お気に入りのみ"]})})]}),(0,r.jsx)("div",{className:"filter-summary",children:m!==h&&(0,r.jsxs)("span",{className:"filter-result",children:[h,"件中",m,"件を表示"]})})]})};t(7049);var g=e=>{let{currentPage:a,totalPages:t,onPageChange:n,itemsPerPage:i,totalItems:l}=e;if(t<=1)return null;let o=Math.min(a*i,l),d=(()=>{let e=[],r=[],s=Math.max(1,a-2),n=Math.min(t,a+2);for(let a=s;a<=n;a++)e.push(a);return s>2?r.push(1,"..."):2===s&&r.push(1),r.push(...e),n<t-1?r.push("...",t):n===t-1&&r.push(t),r})();return(0,r.jsxs)("div",{className:"pagination-container",children:[(0,r.jsxs)("div",{className:"pagination-info",children:[l,"件中 ",(a-1)*i+1,"-",o,"件を表示"]}),(0,r.jsxs)("div",{className:"pagination",children:[(0,r.jsx)("button",{className:"pagination-btn",onClick:()=>n(a-1),disabled:1===a,children:"← 前へ"}),d.map((e,t)=>(0,r.jsx)(s.Fragment,{children:"..."===e?(0,r.jsx)("span",{className:"pagination-dots",children:"..."}):(0,r.jsx)("button",{className:"pagination-btn ".concat(e===a?"active":""),onClick:()=>n(e),children:e})},t)),(0,r.jsx)("button",{className:"pagination-btn",onClick:()=>n(a+1),disabled:a===t,children:"次へ →"})]})]})},h=t(7427);let m=[{word:"accomplish",meaning:"達成する、成し遂げる",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"acquire",meaning:"獲得する、身につける",tags:["動詞","ビジネス","TOEIC"]},{word:"adequate",meaning:"適切な、十分な",tags:["形容詞","ビジネス","TOEIC"]},{word:"administrator",meaning:"管理者、運営者",tags:["名詞","ビジネス","TOEIC"]},{word:"agenda",meaning:"議題、予定表",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"allocate",meaning:"割り当てる、配分する",tags:["動詞","ビジネス","TOEIC"]},{word:"annually",meaning:"年に一度、毎年",tags:["副詞","ビジネス","TOEIC"]},{word:"anticipate",meaning:"予期する、期待する",tags:["動詞","ビジネス","TOEIC"]},{word:"assessment",meaning:"評価、査定",tags:["名詞","ビジネス","TOEIC"]},{word:"authentic",meaning:"本物の、信頼できる",tags:["形容詞","ビジネス","TOEIC"]},{word:"budget",meaning:"予算、予算を組む",tags:["名詞","動詞","経済","TOEIC"],isStarred:!0},{word:"commodity",meaning:"商品、日用品",tags:["名詞","経済","TOEIC"]},{word:"comprehensive",meaning:"包括的な、総合的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"consecutive",meaning:"連続した、継続的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"corporate",meaning:"企業の、法人の",tags:["形容詞","ビジネス","TOEIC"],isStarred:!0},{word:"crucial",meaning:"極めて重要な、決定的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"deficit",meaning:"赤字、不足",tags:["名詞","経済","TOEIC"]},{word:"economical",meaning:"経済的な、節約の",tags:["形容詞","経済","TOEIC"]},{word:"eliminate",meaning:"除去する、削除する",tags:["動詞","ビジネス","TOEIC"]},{word:"estimate",meaning:"見積もる、推定する",tags:["動詞","名詞","ビジネス","TOEIC"]},{word:"implement",meaning:"実行する、実施する",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"innovative",meaning:"革新的な、斬新な",tags:["形容詞","技術","TOEIC"]},{word:"maintenance",meaning:"保守、維持管理",tags:["名詞","技術","TOEIC"]},{word:"manufacture",meaning:"製造する、製造業",tags:["動詞","名詞","製造","TOEIC"]},{word:"operational",meaning:"運営の、操作の",tags:["形容詞","ビジネス","TOEIC"]},{word:"procedure",meaning:"手順、手続き",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"productivity",meaning:"生産性、生産力",tags:["名詞","ビジネス","TOEIC"]},{word:"proposal",meaning:"提案、企画書",tags:["名詞","ビジネス","TOEIC"]},{word:"regulation",meaning:"規則、規制",tags:["名詞","ビジネス","TOEIC"]},{word:"revenue",meaning:"収入、歳入",tags:["名詞","経済","TOEIC"],isStarred:!0},{word:"accomplish",meaning:"達成する、完成させる",tags:["動詞","一般","TOEIC"]},{word:"appropriate",meaning:"適切な、ふさわしい",tags:["形容詞","一般","TOEIC"]},{word:"convenience",meaning:"便利さ、都合",tags:["名詞","一般","TOEIC"]},{word:"demonstrate",meaning:"実演する、証明する",tags:["動詞","一般","TOEIC"]},{word:"efficient",meaning:"効率的な、能率的な",tags:["形容詞","ビジネス","TOEIC"],isStarred:!0},{word:"foundation",meaning:"基礎、土台、財団",tags:["名詞","一般","TOEIC"]},{word:"guarantee",meaning:"保証する、保証",tags:["動詞","名詞","ビジネス","TOEIC"]},{word:"household",meaning:"家庭の、世帯",tags:["形容詞","名詞","一般","TOEIC"]},{word:"instruction",meaning:"指示、指導、説明書",tags:["名詞","一般","TOEIC"]},{word:"merchandise",meaning:"商品、品物",tags:["名詞","ビジネス","TOEIC"]},{word:"negotiate",meaning:"交渉する、取り決める",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"obligation",meaning:"義務、責任",tags:["名詞","ビジネス","TOEIC"]},{word:"outstanding",meaning:"優秀な、未払いの",tags:["形容詞","ビジネス","TOEIC"]},{word:"personnel",meaning:"職員、人事",tags:["名詞","ビジネス","TOEIC"]},{word:"priority",meaning:"優先事項、優先権",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"remarkable",meaning:"注目すべき、驚くべき",tags:["形容詞","一般","TOEIC"]},{word:"reputation",meaning:"評判、名声",tags:["名詞","ビジネス","TOEIC"]},{word:"strategy",meaning:"戦略、計画",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"substantial",meaning:"かなりの、実質的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"transportation",meaning:"輸送、交通機関",tags:["名詞","一般","TOEIC"]}],p=()=>m;class f{static getPageItems(e,a,t){let r=(a-1)*t;return e.slice(r,r+t)}static getTotalPages(e,a){return Math.ceil(e/a)}}class x{static filterCards(e,a,t,r){return e.filter(e=>{if(a){let t=a.toLowerCase(),r=e.word.toLowerCase().includes(t),s=e.meaning.toLowerCase().includes(t);if(!r&&!s)return!1}return!!(!t||e.tags&&e.tags.includes(t))&&(!r||!!e.isStarred)})}static sortCards(e,a,t){let r=[...e];return r.sort((e,r)=>{let s=0;switch(a){case"createdAt":s=new Date(e.created_at).getTime()-new Date(r.created_at).getTime();break;case"updatedAt":s=new Date(e.updated_at).getTime()-new Date(r.updated_at).getTime();break;case"alphabetical":s=e.word.toLowerCase().localeCompare(r.word.toLowerCase())}return"asc"===t?s:-s}),r}static getAllTags(e){let a=new Set;return e.forEach(e=>{e.tags&&e.tags.forEach(e=>a.add(e))}),Array.from(a).sort()}}let v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{itemsPerPage:a=6}=e,{dataManager:t,isCloudMode:r}=(0,h.B)(),[n,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[u,g]=(0,s.useState)(1),[m,v]=(0,s.useState)(""),[w,C]=(0,s.useState)("createdAt"),[j,b]=(0,s.useState)("desc"),[y,E]=(0,s.useState)(!1),[S,N]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{try{o(!0),c(null);let e=await t.getAllCards();if(0===e.length){let e=p(),a=await t.createCards(e);i(a)}else i(e)}catch(e){console.error("Error loading cards:",e),c(e instanceof Error?e.message:"Failed to load cards")}finally{o(!1)}})()},[t]);let{filteredCards:T,availableTags:O,displayCards:I,totalPages:_}=(0,s.useMemo)(()=>{let e=x.filterCards(n,m,S,y),t=x.sortCards(e,w,j),r=f.getPageItems(t,u,a),s=f.getTotalPages(t.length,a);return{filteredCards:t,availableTags:x.getAllTags(n),displayCards:r,totalPages:s}},[n,u,a,m,w,j,y,S]);(0,s.useEffect)(()=>{g(1)},[m,S,y,w,j]);let k=async e=>{let a=n.find(a=>a.id===e);if(a)try{let r=await t.updateCard(e,{isStarred:!a.isStarred});i(a=>a.map(a=>a.id===e?r:a))}catch(e){console.error("Error toggling star:",e),c(e instanceof Error?e.message:"Failed to update card")}};return{cards:n,filteredCards:T,displayCards:I,availableTags:O,totalPages:_,loading:l,error:d,isCloudMode:r,currentPage:u,searchQuery:m,sortBy:w,sortOrder:j,showStarredOnly:y,selectedTag:S,itemsPerPage:a,setSearchQuery:v,setSortBy:C,setSortOrder:b,setShowStarredOnly:E,setSelectedTag:N,handlePageChange:e=>{g(e),window.scrollTo({top:0,behavior:"smooth"})},createCard:async e=>{try{let a=await t.createCard(e);i(e=>[a,...e])}catch(e){console.error("Error creating card:",e),c(e instanceof Error?e.message:"Failed to create card")}},updateCard:async(e,a)=>{try{let r=await t.updateCard(e,a);i(a=>a.map(a=>a.id===e?r:a))}catch(e){console.error("Error updating card:",e),c(e instanceof Error?e.message:"Failed to update card")}},deleteCard:async e=>{if(window.confirm("このカードを削除しますか？"))try{await t.deleteCard(e),i(a=>a.filter(a=>a.id!==e))}catch(e){console.error("Error deleting card:",e),c(e instanceof Error?e.message:"Failed to delete card")}},toggleStar:k,loadSampleData:async()=>{if(window.confirm("現在のデータを削除してTOEIC700点レベルのサンプルデータを読み込みますか？"))try{await t.deleteAllCards();let e=p(),a=await t.createCards(e);i(a),g(1)}catch(e){console.error("Error loading sample data:",e),c(e instanceof Error?e.message:"Failed to load sample data")}}}};function w(){let{user:e,loading:a}=(0,n.a)(),[t,h]=(0,s.useState)("signin"),[m,p]=(0,s.useState)(!1),{cards:f,filteredCards:x,displayCards:w,loading:C,error:j,searchQuery:b,setSearchQuery:y,sortBy:E,setSortBy:S,sortOrder:N,setSortOrder:T,selectedTag:O,setSelectedTag:I,showStarredOnly:_,setShowStarredOnly:k,currentPage:A,handlePageChange:F,totalPages:P,createCard:D,updateCard:M,deleteCard:q,toggleStar:L,loadSampleData:U,availableTags:B}=v(),[G,R]=(0,s.useState)(!1),[z,J]=(0,s.useState)(),H=e=>{J(e),R(!0)},W=()=>{R(!1),J(void 0)},Z=async e=>{await D(e),W()},Q=async e=>{z&&(await M(z.id,e),W())},V=async e=>{window.confirm("この単語カードを削除しますか？")&&await q(e)};return a?(0,r.jsx)(o.Z,{}):e?(0,r.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,r.jsx)("h1",{children:"単語カードアプリ"}),(0,r.jsx)("button",{onClick:()=>p(!m),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:m?"プロフィールを閉じる":"プロフィール"})]}),m&&(0,r.jsx)("div",{style:{marginBottom:"20px"},children:(0,r.jsx)(l,{onClose:()=>p(!1)})}),(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)("button",{onClick:()=>{J(void 0),R(!0)},style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px",marginRight:"10px"},children:"新しい単語カードを追加"}),0===f.length&&(0,r.jsx)("button",{onClick:U,style:{padding:"12px 24px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},children:"サンプルデータを読み込み"})]}),G&&(0,r.jsx)("div",{style:{marginBottom:"20px"},children:(0,r.jsx)(c,{card:z,onSave:z?Q:Z,onCancel:W})}),f.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{searchQuery:b,onSearchChange:y,sortBy:E,onSortByChange:S,sortOrder:N,onSortOrderChange:T,selectedTag:O,onSelectedTagChange:I,showStarredOnly:_,onShowStarredOnlyChange:k,availableTags:B,totalCards:f.length,filteredCards:x.length}),C?(0,r.jsx)(o.Z,{}):w.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px",margin:"20px 0"},children:w.map(e=>(0,r.jsx)(d,{card:e,onEdit:()=>H(e),onDelete:()=>V(e.id),onToggleStar:()=>L(e.id)},e.id))}),P>1&&(0,r.jsx)(g,{currentPage:A,totalPages:P,onPageChange:F,itemsPerPage:6,totalItems:x.length})]}):(0,r.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,r.jsx)("p",{children:"条件に一致する単語カードが見つかりません。"})})]}),j&&(0,r.jsxs)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"12px",borderRadius:"4px",margin:"20px 0"},children:["エラー: ",j]})]}):(0,r.jsxs)("div",{style:{padding:"20px"},children:[(0,r.jsx)("h1",{children:"単語カードアプリ"}),(0,r.jsx)("p",{children:"ログインして単語カードの学習を始めましょう"}),(0,r.jsx)(i,{mode:t,onToggleMode:()=>{h("signin"===t?"signup":"signin")}})]})}},1968:function(e,a,t){"use strict";var r=t(7437);t(2265),t(8487),a.Z=e=>{let{size:a="medium"}=e;return(0,r.jsx)("div",{className:"loading-spinner ".concat(a),children:(0,r.jsx)("div",{className:"spinner"})})}},6281:function(e,a,t){"use strict";t.d(a,{AuthProvider:function(){return o},a:function(){return l}});var r=t(7437),s=t(2265),n=t(2141);let i=(0,s.createContext)(void 0),l=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},o=e=>{let{children:a}=e,[t,l]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),g=(0,n.e)();(0,s.useEffect)(()=>{(async()=>{let{data:{session:e},error:a}=await g.auth.getSession();if(a)console.error("Error getting session:",a);else{var t;d(e),l(null!==(t=null==e?void 0:e.user)&&void 0!==t?t:null)}u(!1)})();let{data:{subscription:e}}=g.auth.onAuthStateChange(async(e,a)=>{var t;console.log("Auth state changed:",e,a),d(a),l(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null),u(!1),"SIGNED_IN"===e&&(null==a?void 0:a.user)&&await h(a.user)});return()=>e.unsubscribe()},[]);let h=async e=>{try{var a,t;let{error:r}=await g.from("user_profiles").upsert([{id:e.id,full_name:(null===(a=e.user_metadata)||void 0===a?void 0:a.full_name)||null,avatar_url:(null===(t=e.user_metadata)||void 0===t?void 0:t.avatar_url)||null,updated_at:new Date().toISOString()}]);r&&console.error("Error updating profile:",r)}catch(e){console.error("Error in createOrUpdateProfile:",e)}},m=async(e,a,t)=>{u(!0);try{return await g.auth.signUp({email:e,password:a,...t&&{options:t}})}finally{u(!1)}},p=async(e,a)=>{u(!0);try{return await g.auth.signInWithPassword({email:e,password:a})}finally{u(!1)}},f=async()=>{u(!0);try{let{error:e}=await g.auth.signOut();if(e)throw e}finally{u(!1)}},x=async e=>await g.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")}),v=async()=>{let e="".concat(window.location.origin,"/auth/callback");return await g.auth.signInWithOAuth({provider:"google",options:{redirectTo:e}})};return(0,r.jsx)(i.Provider,{value:{user:t,session:o,loading:c,signUp:m,signIn:p,signInWithGoogle:v,signOut:f,resetPassword:x},children:a})}},7427:function(e,a,t){"use strict";t.d(a,{DataManagerProvider:function(){return u},B:function(){return g}});var r=t(7437),s=t(2265);let n="wordCards";class i{generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getCurrentTimestamp(){return new Date().toISOString()}getStoredCards(){try{let e=localStorage.getItem(n);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading from localStorage:",e),[]}}saveCards(e){try{localStorage.setItem(n,JSON.stringify(e))}catch(e){throw console.error("Error saving to localStorage:",e),Error("Failed to save data to local storage")}}async getAllCards(){return this.getStoredCards()}async getCard(e){return this.getStoredCards().find(a=>a.id===e)||null}async createCard(e){let a=this.getStoredCards(),t=this.getCurrentTimestamp(),r={...e,id:this.generateId(),created_at:t,updated_at:t};return a.push(r),this.saveCards(a),r}async updateCard(e,a){var t,r;let s=this.getStoredCards(),n=s.findIndex(a=>a.id===e);if(-1===n)throw Error("Card with id ".concat(e," not found"));let i=s[n],l={...i,...a,updated_at:this.getCurrentTimestamp(),id:i.id,word:null!==(t=a.word)&&void 0!==t?t:i.word,meaning:null!==(r=a.meaning)&&void 0!==r?r:i.meaning,created_at:i.created_at};return s[n]=l,this.saveCards(s),l}async deleteCard(e){let a=this.getStoredCards(),t=a.filter(a=>a.id!==e);if(t.length===a.length)throw Error("Card with id ".concat(e," not found"));this.saveCards(t)}async createCards(e){let a=this.getStoredCards(),t=this.getCurrentTimestamp(),r=e.map(e=>({...e,id:this.generateId(),created_at:t,updated_at:t}));return a.push(...r),this.saveCards(a),r}async deleteAllCards(){this.saveCards([])}isOffline(){return!0}}var l=t(2141);class o{setUser(e){this.user=e}ensureAuthenticated(){if(!this.user)throw Error("User must be authenticated to use SupabaseManager")}async getAllCards(){this.ensureAuthenticated();let{data:e,error:a}=await this.supabase.from("word_cards").select("*").eq("user_id",this.user.id).order("created_at",{ascending:!1});if(a)throw console.error("Error fetching cards from Supabase:",a),Error("Failed to fetch cards: ".concat(a.message));return e||[]}async getCard(e){this.ensureAuthenticated();let{data:a,error:t}=await this.supabase.from("word_cards").select("*").eq("id",e).eq("user_id",this.user.id).single();if(t){if("PGRST116"===t.code)return null;throw console.error("Error fetching card from Supabase:",t),Error("Failed to fetch card: ".concat(t.message))}return a}async createCard(e){this.ensureAuthenticated();let{data:a,error:t}=await this.supabase.from("word_cards").insert([{...e,user_id:this.user.id}]).select().single();if(t)throw console.error("Error creating card in Supabase:",t),Error("Failed to create card: ".concat(t.message));return a}async updateCard(e,a){this.ensureAuthenticated();let{data:t,error:r}=await this.supabase.from("word_cards").update({...a,updated_at:new Date().toISOString()}).eq("id",e).eq("user_id",this.user.id).select().single();if(r)throw console.error("Error updating card in Supabase:",r),Error("Failed to update card: ".concat(r.message));if(!t)throw Error("Card with id ".concat(e," not found"));return t}async deleteCard(e){this.ensureAuthenticated();let{error:a}=await this.supabase.from("word_cards").delete().eq("id",e).eq("user_id",this.user.id);if(a)throw console.error("Error deleting card from Supabase:",a),Error("Failed to delete card: ".concat(a.message))}async createCards(e){this.ensureAuthenticated();let a=e.map(e=>({...e,user_id:this.user.id})),{data:t,error:r}=await this.supabase.from("word_cards").insert(a).select();if(r)throw console.error("Error creating cards in Supabase:",r),Error("Failed to create cards: ".concat(r.message));return t||[]}async deleteAllCards(){this.ensureAuthenticated();let{error:e}=await this.supabase.from("word_cards").delete().eq("user_id",this.user.id);if(e)throw console.error("Error deleting all cards from Supabase:",e),Error("Failed to delete all cards: ".concat(e.message))}async syncData(){this.ensureAuthenticated();try{return await this.getAllCards(),{success:!0}}catch(e){return console.error("Error syncing data:",e),{success:!1,errors:[e instanceof Error?e:Error("Unknown sync error")]}}}isOffline(){return!navigator.onLine}async migrateFromLocalStorage(e){this.ensureAuthenticated();try{let a=await this.getAllCards(),t=new Set(a.map(e=>e.id)),r=e.filter(e=>!t.has(e.id));if(0===r.length)return{success:!0};let s=r.map(e=>{let{id:a,created_at:t,updated_at:r,...s}=e;return s});return await this.createCards(s),{success:!0}}catch(e){return console.error("Error migrating from localStorage:",e),{success:!1,errors:[e instanceof Error?e:Error("Migration failed")]}}}constructor(e=null){this.user=null,this.supabase=(0,l.e)(),this.user=e}}var d=t(6281);let c=(0,s.createContext)(void 0),u=e=>{let{children:a}=e,{user:t,loading:n}=(0,d.a)(),[l,u]=(0,s.useState)(new i),[g,h]=(0,s.useState)(!1),[m]=(0,s.useState)(new o);(0,s.useEffect)(()=>{n||(t?(m.setUser(t),u(m),h(!0)):(u(new i),h(!1)))},[t,n,m]);let p=async()=>{if(!t)throw Error("User must be authenticated to switch to cloud mode");m.setUser(t),u(m),h(!0)},f=async()=>{if(!t)return console.error("Cannot migrate to cloud: user not authenticated"),!1;try{let e=new i,a=await e.getAllCards();if(0===a.length)return!0;let t=await m.migrateFromLocalStorage(a);if(t.success)return console.log("Successfully migrated ".concat(a.length," cards to cloud")),!0;return console.error("Migration failed:",t.errors),!1}catch(e){return console.error("Error during migration:",e),!1}};return(0,r.jsx)(c.Provider,{value:{dataManager:l,isCloudMode:g,switchToCloud:p,switchToLocal:()=>{u(new i),h(!1)},migrateToCloud:f},children:a})},g=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useDataManager must be used within a DataManagerProvider");return e}},2141:function(e,a,t){"use strict";t.d(a,{e:function(){return s}});var r=t(5452);let s=()=>(0,r.createClientComponentClient)();(0,r.createClientComponentClient)()},1030:function(){},8487:function(){},6810:function(){},6428:function(){},7049:function(){},9141:function(){},3190:function(){}},function(e){e.O(0,[541,338,262,452,971,117,744],function(){return e(e.s=7636)}),_N_E=e.O()}]);