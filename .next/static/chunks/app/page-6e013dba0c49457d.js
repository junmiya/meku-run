(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2967:function(e,a,s){Promise.resolve().then(s.bind(s,1581))},1581:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return w}});var t=s(7437),r=s(2265),n=s(4362);s(5584);var i=e=>{let{mode:a,onToggleMode:s}=e,{signIn:i,signUp:l,signInWithGoogle:o,resetPassword:d,loading:c}=(0,n.a)(),[g,m]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(""),[j,b]=(0,r.useState)(null),[v,f]=(0,r.useState)(null),[C,w]=(0,r.useState)(!1),N=async e=>{if(e.preventDefault(),b(null),f(null),!g.trim()||!u.trim()){b("メールアドレスとパスワードを入力してください");return}if("signup"===a&&!x.trim()){b("氏名を入力してください");return}try{"signin"===a?await i(g,u):(await l(g,u,x),f("アカウントが作成されました"))}catch(e){console.error("Full auth error:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),b(E(e.code||e.message))}},y=async e=>{if(e.preventDefault(),b(null),f(null),!g.trim()){b("メールアドレスを入力してください");return}try{await d(g),f("パスワードリセットメールを送信しました"),w(!1)}catch(e){console.error("Reset password error:",e),b(E(e.code||e.message))}},E=e=>({"auth/invalid-email":"メールアドレスの形式が正しくありません","auth/user-disabled":"このアカウントは無効化されています","auth/user-not-found":"このメールアドレスのアカウントが見つかりません","auth/wrong-password":"パスワードが間違っています","auth/invalid-credential":"メールアドレスまたはパスワードが正しくありません","auth/too-many-requests":"ログイン試行回数が多すぎます。しばらく待ってから再試行してください","auth/popup-closed-by-user":"ログインがキャンセルされました","auth/weak-password":"パスワードは6文字以上で入力してください","auth/email-already-in-use":"このメールアドレスは既に使用されています",認証機能が無効になっています:"認証機能が無効になっています"})[e]||"エラー: ".concat(e);return C?(0,t.jsxs)("div",{className:"auth-form",children:[(0,t.jsx)("h2",{children:"パスワードリセット"}),(0,t.jsxs)("form",{onSubmit:y,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"reset-email",children:"メールアドレス"}),(0,t.jsx)("input",{type:"email",id:"reset-email",value:g,onChange:e=>m(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),j&&(0,t.jsx)("div",{className:"error-message",children:j}),v&&(0,t.jsx)("div",{className:"success-message",children:v}),(0,t.jsx)("button",{type:"submit",disabled:c,className:"auth-button",children:c?"リセット中...":"パスワードリセット"}),(0,t.jsx)("button",{type:"button",onClick:()=>w(!1),className:"link-button",children:"ログインに戻る"})]})]}):(0,t.jsxs)("div",{className:"auth-form",children:[(0,t.jsx)("h2",{children:"signin"===a?"ログイン":"アカウント作成"}),(0,t.jsxs)("form",{onSubmit:N,children:["signup"===a&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"fullName",children:"氏名"}),(0,t.jsx)("input",{type:"text",id:"fullName",value:x,onChange:e=>p(e.target.value),placeholder:"氏名を入力",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"email",children:"メールアドレス"}),(0,t.jsx)("input",{type:"email",id:"email",value:g,onChange:e=>m(e.target.value),placeholder:"メールアドレスを入力",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"password",children:"パスワード"}),(0,t.jsx)("input",{type:"password",id:"password",value:u,onChange:e=>h(e.target.value),placeholder:"パスワードを入力（6文字以上）",minLength:6,required:!0})]}),j&&(0,t.jsx)("div",{className:"error-message",children:j}),v&&(0,t.jsx)("div",{className:"success-message",children:v}),(0,t.jsx)("button",{type:"submit",disabled:c,className:"auth-button",children:c?"signin"===a?"ログイン中...":"アカウント作成中...":"signin"===a?"ログイン":"アカウント作成"}),(0,t.jsxs)("div",{className:"auth-links",children:["signin"===a&&(0,t.jsx)("button",{type:"button",onClick:()=>w(!0),className:"link-button",children:"パスワードを忘れた方"}),(0,t.jsx)("button",{type:"button",onClick:s,className:"link-button",children:"signin"===a?"アカウントをお持ちでない方はこちら":"既にアカウントをお持ちの方はこちら"})]})]})]})};s(968);var l=e=>{var a,s;let{onClose:i}=e,{user:l,signOut:o}=(0,n.a)(),[d,c]=(0,r.useState)(!1),g=async()=>{c(!0);try{await o()}catch(e){console.error("Sign out error:",e),c(!1)}};return l?(0,t.jsx)("div",{className:"user-profile-overlay",children:(0,t.jsxs)("div",{className:"user-profile",children:[(0,t.jsxs)("div",{className:"profile-header",children:[(0,t.jsx)("h3",{children:"プロフィール"}),(0,t.jsx)("button",{onClick:i,className:"close-button",children:"\xd7"})]}),(0,t.jsxs)("div",{className:"profile-content",children:[(0,t.jsxs)("div",{className:"profile-info",children:[(0,t.jsx)("div",{className:"avatar",children:l.photoURL?(0,t.jsx)("img",{src:l.photoURL,alt:"Avatar"}):(0,t.jsx)("div",{className:"avatar-placeholder",children:(null===(a=l.displayName)||void 0===a?void 0:a.charAt(0))||(null===(s=l.email)||void 0===s?void 0:s.charAt(0))||"?"})}),(0,t.jsxs)("div",{className:"user-details",children:[(0,t.jsx)("p",{className:"user-name",children:l.displayName||"ユーザー"}),(0,t.jsx)("p",{className:"user-email",children:l.email})]})]}),(0,t.jsxs)("div",{className:"profile-stats",children:[(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"アカウント作成日"}),(0,t.jsx)("span",{className:"stat-value",children:l.metadata.creationTime?new Date(l.metadata.creationTime).toLocaleDateString("ja-JP"):"不明"})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"最終ログイン"}),(0,t.jsx)("span",{className:"stat-value",children:l.metadata.lastSignInTime?new Date(l.metadata.lastSignInTime).toLocaleDateString("ja-JP"):"不明"})]})]}),(0,t.jsx)("div",{className:"profile-actions",children:(0,t.jsx)("button",{onClick:g,disabled:d,className:"signout-button",children:d?"ログアウト中...":"ログアウト"})})]})]})}):null};s(7062);var o=e=>{let{size:a="medium"}=e;return(0,t.jsx)("div",{className:"loading-spinner ".concat(a),children:(0,t.jsx)("div",{className:"spinner"})})};s(7959);var d=e=>{let{card:a,onEdit:s,onDelete:n,onToggleStar:i}=e,[l,o]=(0,r.useState)(!1);return(0,t.jsxs)("div",{className:"card-container",children:[(0,t.jsxs)("div",{className:"card ".concat(l?"flipped":""),onClick:()=>{o(!l)},children:[(0,t.jsx)("div",{className:"card-face front",children:(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{children:a.word}),a.tags&&a.tags.length>0&&(0,t.jsx)("div",{className:"tags",children:a.tags.map((e,a)=>(0,t.jsx)("span",{className:"tag",children:e},a))})]})}),(0,t.jsx)("div",{className:"card-face back",children:(0,t.jsx)("div",{className:"card-content",children:(0,t.jsx)("p",{children:a.meaning})})})]}),(0,t.jsxs)("div",{className:"card-actions",children:[(0,t.jsx)("button",{className:"star-btn ".concat(a.isStarred?"starred":""),onClick:e=>{e.stopPropagation(),null==i||i(a.id)},children:"★"}),(0,t.jsx)("button",{className:"edit-btn",onClick:e=>{e.stopPropagation(),null==s||s(a)},children:"編集"}),(0,t.jsx)("button",{className:"delete-btn",onClick:e=>{e.stopPropagation(),null==n||n(a.id)},children:"削除"})]})]})};s(3672);var c=e=>{let{card:a,onSave:s,onCancel:n}=e,[i,l]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[c,g]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(a){var e;l(a.word),d(a.meaning),g((null===(e=a.tags)||void 0===e?void 0:e.join(", "))||""),u(a.isStarred||!1)}},[a]),(0,t.jsx)("div",{className:"card-form-overlay",children:(0,t.jsxs)("div",{className:"card-form",children:[(0,t.jsx)("h2",{children:a?"単語カードを編集":"新しい単語カードを作成"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!i.trim()||!o.trim()){alert("単語と意味を入力してください");return}let a=c.split(",").map(e=>e.trim()).filter(e=>e.length>0);s({word:i.trim(),meaning:o.trim(),isStarred:m,...a.length>0&&{tags:a}}),l(""),d(""),g(""),u(!1)},children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"word",children:"単語"}),(0,t.jsx)("input",{type:"text",id:"word",value:i,onChange:e=>l(e.target.value),placeholder:"単語を入力",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"meaning",children:"意味"}),(0,t.jsx)("textarea",{id:"meaning",value:o,onChange:e=>d(e.target.value),placeholder:"意味を入力",rows:3,required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"tags",children:"タグ（カンマ区切り）"}),(0,t.jsx)("input",{type:"text",id:"tags",value:c,onChange:e=>g(e.target.value),placeholder:"タグ1, タグ2, タグ3"})]}),(0,t.jsx)("div",{className:"form-group checkbox-group",children:(0,t.jsxs)("label",{children:[(0,t.jsx)("input",{type:"checkbox",checked:m,onChange:e=>u(e.target.checked)}),"お気に入り"]})}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"button",onClick:n,className:"cancel-btn",children:"キャンセル"}),(0,t.jsx)("button",{type:"submit",className:"save-btn",children:a?"更新":"保存"})]})]})]})})};s(5283);var g=e=>{let{searchQuery:a,onSearchChange:s,sortBy:r,onSortByChange:n,sortOrder:i,onSortOrderChange:l,showStarredOnly:o,onShowStarredOnlyChange:d,selectedTag:c,onSelectedTagChange:g,availableTags:m,totalCards:u,filteredCards:h}=e;return(0,t.jsxs)("div",{className:"search-filter",children:[(0,t.jsx)("div",{className:"search-section",children:(0,t.jsxs)("div",{className:"search-input-container",children:[(0,t.jsx)("input",{type:"text",placeholder:"単語や意味で検索...",value:a,onChange:e=>s(e.target.value),className:"search-input"}),a&&(0,t.jsx)("button",{className:"clear-search",onClick:()=>s(""),children:"\xd7"})]})}),(0,t.jsxs)("div",{className:"filter-section",children:[(0,t.jsxs)("div",{className:"filter-group",children:[(0,t.jsx)("label",{children:"並び順:"}),(0,t.jsxs)("select",{value:r,onChange:e=>n(e.target.value),className:"filter-select",children:[(0,t.jsx)("option",{value:"createdAt",children:"作成日"}),(0,t.jsx)("option",{value:"updatedAt",children:"更新日"}),(0,t.jsx)("option",{value:"alphabetical",children:"アルファベット順"})]}),(0,t.jsx)("button",{className:"sort-order-btn ".concat("desc"===i?"desc":"asc"),onClick:()=>l("asc"===i?"desc":"asc"),title:"asc"===i?"昇順":"降順",children:"asc"===i?"↑":"↓"})]}),(0,t.jsxs)("div",{className:"filter-group",children:[(0,t.jsx)("label",{children:"タグ:"}),(0,t.jsxs)("select",{value:c,onChange:e=>g(e.target.value),className:"filter-select",children:[(0,t.jsx)("option",{value:"",children:"すべて"}),m.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsx)("div",{className:"filter-group",children:(0,t.jsxs)("label",{className:"checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",checked:o,onChange:e=>d(e.target.checked)}),"お気に入りのみ"]})})]}),(0,t.jsx)("div",{className:"filter-summary",children:h!==u&&(0,t.jsxs)("span",{className:"filter-result",children:[u,"件中",h,"件を表示"]})})]})};s(2810);var m=e=>{let{currentPage:a,totalPages:s,onPageChange:n,itemsPerPage:i,totalItems:l}=e;if(s<=1)return null;let o=Math.min(a*i,l),d=(()=>{let e=[],t=[],r=Math.max(1,a-2),n=Math.min(s,a+2);for(let a=r;a<=n;a++)e.push(a);return r>2?t.push(1,"..."):2===r&&t.push(1),t.push(...e),n<s-1?t.push("...",s):n===s-1&&t.push(s),t})();return(0,t.jsxs)("div",{className:"pagination-container",children:[(0,t.jsxs)("div",{className:"pagination-info",children:[l,"件中 ",(a-1)*i+1,"-",o,"件を表示"]}),(0,t.jsxs)("div",{className:"pagination",children:[(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>n(a-1),disabled:1===a,children:"← 前へ"}),d.map((e,s)=>(0,t.jsx)(r.Fragment,{children:"..."===e?(0,t.jsx)("span",{className:"pagination-dots",children:"..."}):(0,t.jsx)("button",{className:"pagination-btn ".concat(e===a?"active":""),onClick:()=>n(e),children:e})},s)),(0,t.jsx)("button",{className:"pagination-btn",onClick:()=>n(a+1),disabled:a===s,children:"次へ →"})]})]})},u=s(6956),h=s(7442),x=s(763);let p=e=>{let{isOpen:a,onClose:s}=e,{user:i,isAuthEnabled:l}=(0,n.a)(),{dataManager:o}=(0,u.B)(),[d,c]=(0,r.useState)(!1),[g,m]=(0,r.useState)(null),[p,j]=(0,r.useState)(0),[b,v]=(0,r.useState)(0);r.useEffect(()=>{a&&l&&i&&f()},[a,l,i]);let f=async()=>{try{let e=new h.A,a=await e.getAllCards();if(j(a.length),i){let e=new x.q(i),a=await e.getAllCards();v(a.length)}}catch(e){console.error("Error checking data counts:",e)}},C=async()=>{if(!i||!l){m("認証が必要です");return}c(!0),m(null);try{let a=new h.A,s=await a.getAllCards();if(0===s.length){m("LocalStorageにデータがありません"),c(!1);return}let t=new x.q(i),r=await t.migrateFromLocalStorage(s);if(r.success)m("移行完了: ".concat(s.length,"件のデータを処理しました")),await f();else{var e;m("移行エラー: ".concat(null===(e=r.errors)||void 0===e?void 0:e.map(e=>e.message).join(", ")))}}catch(e){console.error("Migration error:",e),m("移行エラー: ".concat(e))}finally{c(!1)}},w=async()=>{if(window.confirm("LocalStorageのデータを削除しますか？この操作は取り消せません。"))try{let e=new h.A;await e.deleteAllCards(),j(0),m("LocalStorageのデータを削除しました")}catch(e){console.error("Error clearing localStorage:",e),m("削除エラー: ".concat(e))}};return a?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"データ移行"}),l?i?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"現在のデータ状況"}),(0,t.jsxs)("div",{className:"bg-gray-100 p-3 rounded",children:[(0,t.jsxs)("p",{children:["LocalStorage: ",p,"件"]}),(0,t.jsxs)("p",{children:["Firestore: ",b,"件"]})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"移行について"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["LocalStorageからFirestoreにデータを移行します。",(0,t.jsx)("br",{}),"重複したデータは作成されません。"]})]}),g&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-blue-100 border border-blue-300 rounded",children:(0,t.jsx)("p",{className:"text-sm",children:g})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("button",{onClick:C,disabled:d||0===p,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:d?"移行中...":"データを移行する"}),(0,t.jsx)("button",{onClick:w,disabled:d||0===p,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:bg-gray-400",children:"LocalStorageを削除"}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"閉じる"})]})]}):(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"mb-4",children:"データ移行にはログインが必要です。"}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"閉じる"})]}):(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"mb-4",children:"認証機能が無効のため、データ移行は利用できません。"}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"閉じる"})]})]})}):null},j=[{word:"accomplish",meaning:"達成する、成し遂げる",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"acquire",meaning:"獲得する、身につける",tags:["動詞","ビジネス","TOEIC"]},{word:"adequate",meaning:"適切な、十分な",tags:["形容詞","ビジネス","TOEIC"]},{word:"administrator",meaning:"管理者、運営者",tags:["名詞","ビジネス","TOEIC"]},{word:"agenda",meaning:"議題、予定表",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"allocate",meaning:"割り当てる、配分する",tags:["動詞","ビジネス","TOEIC"]},{word:"annually",meaning:"年に一度、毎年",tags:["副詞","ビジネス","TOEIC"]},{word:"anticipate",meaning:"予期する、期待する",tags:["動詞","ビジネス","TOEIC"]},{word:"assessment",meaning:"評価、査定",tags:["名詞","ビジネス","TOEIC"]},{word:"authentic",meaning:"本物の、信頼できる",tags:["形容詞","ビジネス","TOEIC"]},{word:"budget",meaning:"予算、予算を組む",tags:["名詞","動詞","経済","TOEIC"],isStarred:!0},{word:"commodity",meaning:"商品、日用品",tags:["名詞","経済","TOEIC"]},{word:"comprehensive",meaning:"包括的な、総合的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"consecutive",meaning:"連続した、継続的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"corporate",meaning:"企業の、法人の",tags:["形容詞","ビジネス","TOEIC"],isStarred:!0},{word:"crucial",meaning:"極めて重要な、決定的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"deficit",meaning:"赤字、不足",tags:["名詞","経済","TOEIC"]},{word:"economical",meaning:"経済的な、節約の",tags:["形容詞","経済","TOEIC"]},{word:"eliminate",meaning:"除去する、削除する",tags:["動詞","ビジネス","TOEIC"]},{word:"estimate",meaning:"見積もる、推定する",tags:["動詞","名詞","ビジネス","TOEIC"]},{word:"implement",meaning:"実行する、実施する",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"innovative",meaning:"革新的な、斬新な",tags:["形容詞","技術","TOEIC"]},{word:"maintenance",meaning:"保守、維持管理",tags:["名詞","技術","TOEIC"]},{word:"manufacture",meaning:"製造する、製造業",tags:["動詞","名詞","製造","TOEIC"]},{word:"operational",meaning:"運営の、操作の",tags:["形容詞","ビジネス","TOEIC"]},{word:"procedure",meaning:"手順、手続き",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"productivity",meaning:"生産性、生産力",tags:["名詞","ビジネス","TOEIC"]},{word:"proposal",meaning:"提案、企画書",tags:["名詞","ビジネス","TOEIC"]},{word:"regulation",meaning:"規則、規制",tags:["名詞","ビジネス","TOEIC"]},{word:"revenue",meaning:"収入、歳入",tags:["名詞","経済","TOEIC"],isStarred:!0},{word:"accomplish",meaning:"達成する、完成させる",tags:["動詞","一般","TOEIC"]},{word:"appropriate",meaning:"適切な、ふさわしい",tags:["形容詞","一般","TOEIC"]},{word:"convenience",meaning:"便利さ、都合",tags:["名詞","一般","TOEIC"]},{word:"demonstrate",meaning:"実演する、証明する",tags:["動詞","一般","TOEIC"]},{word:"efficient",meaning:"効率的な、能率的な",tags:["形容詞","ビジネス","TOEIC"],isStarred:!0},{word:"foundation",meaning:"基礎、土台、財団",tags:["名詞","一般","TOEIC"]},{word:"guarantee",meaning:"保証する、保証",tags:["動詞","名詞","ビジネス","TOEIC"]},{word:"household",meaning:"家庭の、世帯",tags:["形容詞","名詞","一般","TOEIC"]},{word:"instruction",meaning:"指示、指導、説明書",tags:["名詞","一般","TOEIC"]},{word:"merchandise",meaning:"商品、品物",tags:["名詞","ビジネス","TOEIC"]},{word:"negotiate",meaning:"交渉する、取り決める",tags:["動詞","ビジネス","TOEIC"],isStarred:!0},{word:"obligation",meaning:"義務、責任",tags:["名詞","ビジネス","TOEIC"]},{word:"outstanding",meaning:"優秀な、未払いの",tags:["形容詞","ビジネス","TOEIC"]},{word:"personnel",meaning:"職員、人事",tags:["名詞","ビジネス","TOEIC"]},{word:"priority",meaning:"優先事項、優先権",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"remarkable",meaning:"注目すべき、驚くべき",tags:["形容詞","一般","TOEIC"]},{word:"reputation",meaning:"評判、名声",tags:["名詞","ビジネス","TOEIC"]},{word:"strategy",meaning:"戦略、計画",tags:["名詞","ビジネス","TOEIC"],isStarred:!0},{word:"substantial",meaning:"かなりの、実質的な",tags:["形容詞","ビジネス","TOEIC"]},{word:"transportation",meaning:"輸送、交通機関",tags:["名詞","一般","TOEIC"]}],b=()=>j;class v{static getPageItems(e,a,s){let t=(a-1)*s;return e.slice(t,t+s)}static getTotalPages(e,a){return Math.ceil(e/a)}}class f{static filterCards(e,a,s,t){return e.filter(e=>{if(a){let s=a.toLowerCase(),t=e.word.toLowerCase().includes(s),r=e.meaning.toLowerCase().includes(s);if(!t&&!r)return!1}return!!(!s||e.tags&&e.tags.includes(s))&&(!t||!!e.isStarred)})}static sortCards(e,a,s){let t=[...e];return t.sort((e,t)=>{let r=0;switch(a){case"createdAt":r=new Date(e.created_at).getTime()-new Date(t.created_at).getTime();break;case"updatedAt":r=new Date(e.updated_at).getTime()-new Date(t.updated_at).getTime();break;case"alphabetical":r=e.word.toLowerCase().localeCompare(t.word.toLowerCase())}return"asc"===s?r:-r}),t}static getAllTags(e){let a=new Set;return e.forEach(e=>{e.tags&&e.tags.forEach(e=>a.add(e))}),Array.from(a).sort()}}let C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{itemsPerPage:a=6}=e,{dataManager:s,isCloudMode:t}=(0,u.B)(),[n,i]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),[g,m]=(0,r.useState)(1),[h,x]=(0,r.useState)(""),[p,j]=(0,r.useState)("createdAt"),[C,w]=(0,r.useState)("desc"),[N,y]=(0,r.useState)(!1),[E,S]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{try{o(!0),c(null);let e=await s.getAllCards();if(0===e.length){let e=b(),a=await s.createCards(e);i(a)}else i(e)}catch(e){console.error("Error loading cards:",e),c(e instanceof Error?e.message:"Failed to load cards")}finally{o(!1)}})()},[s]);let{filteredCards:T,availableTags:O,displayCards:I,totalPages:k}=(0,r.useMemo)(()=>{let e=f.filterCards(n,h,E,N),s=f.sortCards(e,p,C),t=v.getPageItems(s,g,a),r=v.getTotalPages(s.length,a);return{filteredCards:s,availableTags:f.getAllTags(n),displayCards:t,totalPages:r}},[n,g,a,h,p,C,N,E]);(0,r.useEffect)(()=>{m(1)},[h,E,N,p,C]);let A=async e=>{let a=n.find(a=>a.id===e);if(a)try{let t=await s.updateCard(e,{isStarred:!a.isStarred});i(a=>a.map(a=>a.id===e?t:a))}catch(e){console.error("Error toggling star:",e),c(e instanceof Error?e.message:"Failed to update card")}};return{cards:n,filteredCards:T,displayCards:I,availableTags:O,totalPages:k,loading:l,error:d,isCloudMode:t,currentPage:g,searchQuery:h,sortBy:p,sortOrder:C,showStarredOnly:N,selectedTag:E,itemsPerPage:a,setSearchQuery:x,setSortBy:j,setSortOrder:w,setShowStarredOnly:y,setSelectedTag:S,handlePageChange:e=>{m(e),window.scrollTo({top:0,behavior:"smooth"})},createCard:async e=>{try{let a=await s.createCard(e);i(e=>[a,...e])}catch(e){console.error("Error creating card:",e),c(e instanceof Error?e.message:"Failed to create card")}},updateCard:async(e,a)=>{try{let t=await s.updateCard(e,a);i(a=>a.map(a=>a.id===e?t:a))}catch(e){console.error("Error updating card:",e),c(e instanceof Error?e.message:"Failed to update card")}},deleteCard:async e=>{if(window.confirm("このカードを削除しますか？"))try{await s.deleteCard(e),i(a=>a.filter(a=>a.id!==e))}catch(e){console.error("Error deleting card:",e),c(e instanceof Error?e.message:"Failed to delete card")}},toggleStar:A,loadSampleData:async()=>{if(window.confirm("現在のデータを削除してTOEIC700点レベルのサンプルデータを読み込みますか？"))try{await s.deleteAllCards();let e=b(),a=await s.createCards(e);i(a),m(1)}catch(e){console.error("Error loading sample data:",e),c(e instanceof Error?e.message:"Failed to load sample data")}}}};function w(){let{user:e,loading:a,isAuthEnabled:s}=(0,n.a)();console.log("HomePage - Auth Status:",{user:e,loading:a,isAuthEnabled:s});let[u,h]=(0,r.useState)("signin"),[x,j]=(0,r.useState)(!1),[b,v]=(0,r.useState)(!1),{cards:f,filteredCards:w,displayCards:N,loading:y,error:E,searchQuery:S,setSearchQuery:T,sortBy:O,setSortBy:I,sortOrder:k,setSortOrder:A,selectedTag:F,setSelectedTag:P,showStarredOnly:L,setShowStarredOnly:D,currentPage:q,handlePageChange:_,totalPages:R,createCard:B,updateCard:M,deleteCard:z,toggleStar:J,loadSampleData:U,availableTags:H}=C(),[Q,W]=(0,r.useState)(!1),[Y,G]=(0,r.useState)(),K=e=>{G(e),W(!0)},V=()=>{W(!1),G(void 0)},X=async e=>{await B(e),V()},Z=async e=>{Y&&(await M(Y.id,e),V())},$=async e=>{window.confirm("この単語カードを削除しますか？")&&await z(e)};return a?(0,t.jsx)(o,{}):e?(0,t.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,t.jsx)("h1",{children:"単語カードアプリ"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{onClick:()=>v(!0),style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"データ移行"}),(0,t.jsx)("button",{onClick:()=>j(!x),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:x?"プロフィールを閉じる":"プロフィール"})]})]}),x&&(0,t.jsx)("div",{style:{marginBottom:"20px"},children:(0,t.jsx)(l,{onClose:()=>j(!1)})}),(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsx)("button",{onClick:()=>{G(void 0),W(!0)},style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px",marginRight:"10px"},children:"新しい単語カードを追加"}),0===f.length&&(0,t.jsx)("button",{onClick:U,style:{padding:"12px 24px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px"},children:"サンプルデータを読み込み"})]}),Q&&(0,t.jsx)("div",{style:{marginBottom:"20px"},children:(0,t.jsx)(c,{card:Y,onSave:Y?Z:X,onCancel:V})}),f.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g,{searchQuery:S,onSearchChange:T,sortBy:O,onSortByChange:I,sortOrder:k,onSortOrderChange:A,selectedTag:F,onSelectedTagChange:P,showStarredOnly:L,onShowStarredOnlyChange:D,availableTags:H,totalCards:f.length,filteredCards:w.length}),y?(0,t.jsx)(o,{}):N.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px",margin:"20px 0"},children:N.map(e=>(0,t.jsx)(d,{card:e,onEdit:()=>K(e),onDelete:()=>$(e.id),onToggleStar:()=>J(e.id)},e.id))}),R>1&&(0,t.jsx)(m,{currentPage:q,totalPages:R,onPageChange:_,itemsPerPage:6,totalItems:w.length})]}):(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,t.jsx)("p",{children:"条件に一致する単語カードが見つかりません。"})})]}),E&&(0,t.jsxs)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"12px",borderRadius:"4px",margin:"20px 0"},children:["エラー: ",E]}),(0,t.jsx)(p,{isOpen:b,onClose:()=>v(!1)})]}):(0,t.jsxs)("div",{style:{padding:"20px"},children:[(0,t.jsx)("h1",{children:"単語カードアプリ"}),(0,t.jsxs)("div",{style:{background:"#f0f0f0",padding:"10px",margin:"10px 0",fontSize:"12px"},children:[(0,t.jsx)("strong",{children:"デバッグ情報:"}),(0,t.jsx)("br",{}),"認証有効: ",s?"ON":"OFF",(0,t.jsx)("br",{}),"ユーザー: ",e?"ログイン済み":"ログインなし",(0,t.jsx)("br",{}),"ローディング: ",a?"YES":"NO"]}),(0,t.jsx)("p",{children:"ログインして単語カードの学習を始めましょう"}),(0,t.jsx)(i,{mode:u,onToggleMode:()=>{h("signin"===u?"signup":"signin")}})]})}},5584:function(){},7062:function(){},968:function(){},3672:function(){},2810:function(){},5283:function(){},7959:function(){}},function(e){e.O(0,[826,358,990,943,956,971,117,744],function(){return e(e.s=2967)}),_N_E=e.O()}]);